
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tugas Akhir Mata Kuliah Penambangan Data &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'wholesalecustomers';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="markdown.html">Markdown Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Content with notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fwholesalecustomers.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/wholesalecustomers.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tugas Akhir Mata Kuliah Penambangan Data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wholesale-customers-dataset">wholesale customers Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#memahami-dataset">Memahami Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-dataset-from-python">Import Dataset From Python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-dataset-ke-csv">Convert Dataset Ke CSV</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menarik-data-dari-mysql">Menarik Data dari Mysql</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visual-tiap-fitur-dataset-wholesale-customers">Visual Tiap Fitur Dataset Wholesale Customers</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepocessing-data">Prepocessing Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mengidentifikasi-missing-values">Mengidentifikasi Missing Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mengidentifikasi-outlier">Mengidentifikasi Outlier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encoding-data">Encoding Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mengidentifikasi-algoritma-knn">Mengidentifikasi Algoritma KNN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mengidentifikasi-lof">Mengidentifikasi LOF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-naive-bayes">Klasifikasi Naive Bayes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-dataset">Modeling Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ensemble-learning-stacking">Ensemble Learning - Stacking</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#base-classifier">Base Classifier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#output-base-classifier">Output Base Classifier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meta-classifier">Meta Classifier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ensemble-learning-bagging">Ensemble Learning - Bagging</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluasi-dataset">Evaluasi Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deploy-dataset">Deploy Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kesimpulan">Kesimpulan</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tugas-akhir-mata-kuliah-penambangan-data">
<h1>Tugas Akhir Mata Kuliah Penambangan Data<a class="headerlink" href="#tugas-akhir-mata-kuliah-penambangan-data" title="Link to this heading">#</a></h1>
<p>Penambangan Data merupakan salah satu mata kuliah yang ditempuh mahasiswa Jurusan Teknik Informatika semester 4 di Universitas Trunojoyo Madura. Pada Mata kuliah ini, mempelejari banyak hal mulai dari Data Understanding, Preprocessing Data, Modelling data, hingga Evaluasi Data yang menghasilkan output berupa tampilan atau interface website dalam proyek akhir nantinya. Dalam proyek ini, dikerjakan secara berkelompok untuk menghasilkan suatu proyek akhir yang menghasilkan suatu website untuk memprediksi class/output tertentu sesuai dengan Dataset (kumpulan data-data mentah berupa tabel yang dapat dioleh lebih lanjut) yang didapatkan dari website pengumpul Dataset (UCI Dataset).</p>
<p>Dalam Proyek Penambangan Data ini mengambil Dataset berupa wholesale customers Data . Berikut ini merupakan penjelasan beserta implementasi dari awal proses hingga akhir yang dimana menghasilkan sebuah website berupa prediksi class dari wholesale customers data.</p>
<section id="wholesale-customers-dataset">
<h2>wholesale customers Dataset<a class="headerlink" href="#wholesale-customers-dataset" title="Link to this heading">#</a></h2>
<p>Wholesale customers data adalah sekumpulan informasi yang berhubungan dengan pelanggan grosir. Data ini biasanya digunakan oleh perusahaan untuk menganalisis perilaku dan kebutuhan pelanggan dalam rangka meningkatkan layanan, mengoptimalkan penawaran produk, dan merancang strategi pemasaran yang lebih efektif. pada data ini terdapat 7 fitur, yaitu sebagai berikut.</p>
<table border="1">
    <tr>
        <th>No</th>
        <th>Nama Fitur</th>
        <th>Type</th>
        <th>Deskripsi</th>
        <th>Value</th>
    </tr>
    <tr>
        <td>1</td>
        <td>Region</td>
        <td>Kategorikal</td>
        <td>Menunjukkan wilayah geografis tempat pelanggan berada. Biasanya dibagi menjadi beberapa kategori</td>
        <td>1, 2, 3</td>
    </tr>
    <tr>
        <td>2</td>
        <td>Fresh</td>
        <td>Numerik</td>
        <td>Menunjukkan total pengeluaran atau jumlah unit yang dibeli oleh pelanggan untuk produk segar</td>
        <td>3 - 112151</td>
    </tr>
    <tr>
        <td>3</td>
        <td>Milk</td>
        <td>Numerik</td>
        <td>Menunjukkan total pengeluaran atau jumlah unit yang dibeli oleh pelanggan untuk produk susu dan olahannya</td>
        <td>55 - 73498</td>
    </tr>
    <tr>
        <td>4</td>
        <td>Grocery</td>
        <td>Numerik</td>
        <td>Menunjukkan total pengeluaran atau jumlah unit yang dibeli oleh pelanggan untuk barang-barang kebutuhan sehari-hari</td>
        <td>3 - 92780</td>
    </tr>
    <tr>
        <td>5</td>
        <td>Frozen</td>
        <td>Numerik</td>
        <td>Menunjukkan total pengeluaran atau jumlah unit yang dibeli oleh pelanggan untuk produk beku</td>
        <td>25 - 60869</td>
    </tr>
    <tr>
        <td>6</td>
        <td>Detergent_Paper</td>
        <td>Numerik</td>
        <td>Menunjukkan total pengeluaran atau jumlah unit yang dibeli oleh pelanggan untuk produk kebersihan dan kertas </td>
        <td>3 - 40827</td>
    </tr>
    <tr>
        <td>7</td>
        <td>Delicassen</td>
        <td>Numerik</td>
        <td>Menunjukkan total pengeluaran atau jumlah unit yang dibeli oleh pelanggan untuk produk delicatessen</td>
        <td>3 - 47943</td>
    </tr>
</table<p>Setiap baris dalam dataset berisi tetang angka penjualan sesuai dengan jenisnya, dan dalam tabel tersebut terdapat kolom channel Menunjukkan saluran distribusi yang digunakan oleh pelanggan grosir keseluruhan. Dataset ini dapat digunakan untuk melatih dan mengevaluasi model klasifikasi yang memprediksi penilaian keseluruhan customers berdasarkan fitur-fiturnya. Berikut merupakan versi tabel untuk mengetahui apa saja yang berada di kolom target untuk hasil akhir dalam memprediksi wholesale customers.</p>
<table border="1">
    <tr>
        <th>Nama Kolom</th>
        <th>Jumlah label</th>
        <th>Deskripsi</th>
        <th>Value</th>
    </tr>
    <tr>
        <td>Channel</td>
        <td>2</td>
        <td>Menunjukkan saluran distribusi yang digunakan oleh pelanggan grosir</td>
        <td>1, 2</td>
    </tr>
</table<p>dari kategori tersebut dapat di jelaskan dari value kolom channel sebagai berikut:</p>
<table border="1">
    <tr>
        <th>Value</th>
        <th>Alias</th>
        <th>Deskripsi</th>
    </tr>
    <tr>
        <td>1</td>
        <td>Horeca</td>
        <td>Pelanggan yang berasal dari industri perhotelan, restoran, dan kafe.</td>
    </tr>
    <tr>
        <td>2</td>
        <td>Retail</td>
        <td>Pelanggan yang menjalankan bisnis ritel seperti supermarket, minimarket, dan toko kelontong.</td>
    </tr>
</table<p>berikut merupakan informasi tentang Wholesale Customers Dataset :</p>
<table border="1">
    <tr>
        <td>Jumlah baris Data</td>
        <td>440</td>
    </tr>
    <tr>
        <td>Jumlah Kolom</td>
        <td>8 (7 Fitur dan 1 Channel)</td>
    </tr>
    <tr>
        <td>Tipe Data</td>
        <td>Numerik</td>
    </tr>
    <tr>
        <td>Missing Values</td>
        <td>Tidak Ada</td>
    </tr>
</table<p>Penggunaan Dataset tersebut sendiri bisa dilakukan untuk Klasifikasi. Klasifikasi yang dimaksud adalah untuk memprediksi penilaian keseluruhan pelanggan berdasarkan fitur-fiturnya.</p>
<p>Data wholesale customers yang mencakup fitur-fitur seperti Channel, Region, Fresh, Milk, Grocery, Frozen, Detergents_Paper, dan Delicassen memiliki berbagai manfaat penting bagi bisnis grosir. Berikut adalah beberapa manfaat utamanya:</p>
<ul class="simple">
<li><p>Identifikasi Segmen Pasar: Data Channel dan Region memungkinkan perusahaan untuk mengidentifikasi dan membedakan segmen pasar mereka, seperti pelanggan Horeca dan Retail di berbagai wilayah geografis.</p></li>
</ul>
<ul class="simple">
<li><p>Manajemen Inventori: Informasi tentang kategori produk (Fresh, Milk, Grocery, Frozen, Detergents_Paper, Delicassen) membantu dalam perencanaan dan manajemen inventori yang lebih baik, memastikan ketersediaan produk sesuai permintaan</p></li>
</ul>
<ul class="simple">
<li><p>Pola Pembelian: Menganalisis data pembelian membantu perusahaan memahami pola pembelian pelanggan, seperti frekuensi pembelian, volume pembelian, dan preferensi produk.</p></li>
</ul>
<ul class="simple">
<li><p>Kampanye Pemasaran yang Ditargetkan: Dengan segmentasi yang jelas, perusahaan dapat mengembangkan kampanye pemasaran yang lebih tepat sasaran, misalnya, promosi khusus untuk pelanggan Horeca atau Retail.</p></li>
</ul>
<ul class="simple">
<li><p>Layanan yang Disesuaikan: Dengan pemahaman yang lebih baik tentang kebutuhan dan preferensi pelanggan, perusahaan dapat menyediakan layanan yang lebih personal dan memuaskan.</p></li>
</ul>
<p>Secara keseluruhan, data wholesale customers adalah aset berharga yang membantu perusahaan grosir dalam memahami dan melayani pelanggan mereka dengan lebih efektif, meningkatkan efisiensi operasional, dan mengembangkan strategi bisnis yang lebih baik.</p>
</section>
<section id="memahami-dataset">
<h2>Memahami Dataset<a class="headerlink" href="#memahami-dataset" title="Link to this heading">#</a></h2>
<p>Memahami dataset adalah langkah krusial dalam analisis data yang memungkinkan untuk mendapatkan wawasan yang mendalam tentang informasi yang terkandung di dalamnya. Proses memahami dataset melibatkan beberapa langkah penting untuk menjelajahi, menganalisis, dan menginterpretasi data.</p>
<p>Berikut ini merupakan implementasi untuk tahap Memahami Dataset untuk Wholesale Customers, di antaranya:</p>
<section id="import-dataset-from-python">
<h3>Import Dataset From Python<a class="headerlink" href="#import-dataset-from-python" title="Link to this heading">#</a></h3>
<p>Mula-mula dilakukan Import Dataset dari Python yang bermula dari dataset ‘Wholesale Customers’ yang bersumber dari UCI Dataset. Kemudian dilakukan langkah-langkah Python sesuai prosedur yang telah tersedia pada keterangan Dataset tersebut.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">ucimlrepo</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: ucimlrepo in c:\users\adm\appdata\local\programs\python\python310\lib\site-packages (0.0.7)
Requirement already satisfied: certifi&gt;=2020.12.5 in c:\users\adm\appdata\local\programs\python\python310\lib\site-packages (from ucimlrepo) (2024.6.2)
Requirement already satisfied: pandas&gt;=1.0.0 in c:\users\adm\appdata\local\programs\python\python310\lib\site-packages (from ucimlrepo) (2.2.2)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in c:\users\adm\appdata\local\programs\python\python310\lib\site-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2.8.2)
Requirement already satisfied: tzdata&gt;=2022.7 in c:\users\adm\appdata\local\programs\python\python310\lib\site-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2024.1)
Requirement already satisfied: numpy&gt;=1.22.4 in c:\users\adm\appdata\local\programs\python\python310\lib\site-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2.0.0)
Requirement already satisfied: pytz&gt;=2020.1 in c:\users\adm\appdata\local\programs\python\python310\lib\site-packages (from pandas&gt;=1.0.0-&gt;ucimlrepo) (2024.1)
Requirement already satisfied: six&gt;=1.5 in c:\users\adm\appdata\local\programs\python\python310\lib\site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas&gt;=1.0.0-&gt;ucimlrepo) (1.16.0)
Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[notice] A new release of pip available: 22.2.1 -&gt; 24.1
[notice] To update, run: python.exe -m pip install --upgrade pip
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ucimlrepo</span> <span class="kn">import</span> <span class="n">fetch_ucirepo</span> 
  
<span class="c1"># fetch dataset </span>
<span class="n">wholesale_customers</span> <span class="o">=</span> <span class="n">fetch_ucirepo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">292</span><span class="p">)</span> 
  
<span class="c1"># data (as pandas dataframes) </span>
<span class="n">X</span> <span class="o">=</span> <span class="n">wholesale_customers</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">features</span> 
<span class="n">y</span> <span class="o">=</span> <span class="n">wholesale_customers</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">targets</span> 
  
<span class="c1"># metadata </span>
<span class="nb">print</span><span class="p">(</span><span class="n">wholesale_customers</span><span class="o">.</span><span class="n">metadata</span><span class="p">)</span> 
  
<span class="c1"># variable information </span>
<span class="nb">print</span><span class="p">(</span><span class="n">wholesale_customers</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;uci_id&#39;: 292, &#39;name&#39;: &#39;Wholesale customers&#39;, &#39;repository_url&#39;: &#39;https://archive.ics.uci.edu/dataset/292/wholesale+customers&#39;, &#39;data_url&#39;: &#39;https://archive.ics.uci.edu/static/public/292/data.csv&#39;, &#39;abstract&#39;: &#39;The data set refers to clients of a wholesale distributor. It includes the annual spending in monetary units (m.u.) on diverse product categories&#39;, &#39;area&#39;: &#39;Business&#39;, &#39;tasks&#39;: [&#39;Classification&#39;, &#39;Clustering&#39;], &#39;characteristics&#39;: [&#39;Multivariate&#39;], &#39;num_instances&#39;: 440, &#39;num_features&#39;: 7, &#39;feature_types&#39;: [&#39;Integer&#39;], &#39;demographics&#39;: [], &#39;target_col&#39;: [&#39;Region&#39;], &#39;index_col&#39;: None, &#39;has_missing_values&#39;: &#39;no&#39;, &#39;missing_values_symbol&#39;: None, &#39;year_of_dataset_creation&#39;: 2013, &#39;last_updated&#39;: &#39;Mon Feb 05 2024&#39;, &#39;dataset_doi&#39;: &#39;10.24432/C5030X&#39;, &#39;creators&#39;: [&#39;Margarida Cardoso&#39;], &#39;intro_paper&#39;: None, &#39;additional_info&#39;: {&#39;summary&#39;: None, &#39;purpose&#39;: None, &#39;funded_by&#39;: None, &#39;instances_represent&#39;: None, &#39;recommended_data_splits&#39;: None, &#39;sensitive_data&#39;: None, &#39;preprocessing_description&#39;: None, &#39;variable_info&#39;: &#39;1)\tFRESH: annual spending (m.u.) on fresh products (Continuous);\r\n2)\tMILK: annual spending (m.u.) on milk products (Continuous);\r\n3)\tGROCERY: annual spending (m.u.)on grocery products (Continuous);\r\n4)\tFROZEN: annual spending (m.u.)on frozen products (Continuous)\r\n5)\tDETERGENTS_PAPER: annual spending (m.u.) on detergents and paper products (Continuous) \r\n6)\tDELICATESSEN: annual spending (m.u.)on and delicatessen products (Continuous); \r\n7)\tCHANNEL: customersâ€™ Channel - Horeca (Hotel/Restaurant/CafÃ©) or Retail channel (Nominal)\r\n8)\tREGION: customersâ€™ Region â€“ Lisnon, Oporto or Other (Nominal)\r\nDescriptive Statistics:\r\n\r\n\t(Minimum, Maximum, Mean, Std. Deviation)\r\nFRESH (\t3, 112151, 12000.30, 12647.329)\r\nMILK\t(55, 73498, 5796.27, 7380.377)\r\nGROCERY\t(3, 92780, 7951.28, 9503.163)\r\nFROZEN\t(25, 60869, 3071.93, 4854.673)\r\nDETERGENTS_PAPER (3, 40827, 2881.49, 4767.854)\r\nDELICATESSEN (3, 47943, 1524.87, 2820.106)\r\n\r\nREGION\tFrequency\r\nLisbon\t77\r\nOporto\t47\r\nOther Region\t316\r\nTotal\t440\r\n\r\nCHANNEL\tFrequency\r\nHoreca\t298\r\nRetail\t142\r\nTotal\t440\r\n&#39;, &#39;citation&#39;: None}}
               name     role         type demographic description units  \
0           Channel  Feature  Categorical        None        None  None   
1            Region   Target  Categorical        None        None  None   
2             Fresh  Feature      Integer        None        None  None   
3              Milk  Feature      Integer        None        None  None   
4           Grocery  Feature      Integer        None        None  None   
5            Frozen  Feature      Integer        None        None  None   
6  Detergents_Paper  Feature      Integer        None        None  None   
7        Delicassen  Feature      Integer        None        None  None   

  missing_values  
0             no  
1             no  
2             no  
3             no  
4             no  
5             no  
6             no  
7             no  
</pre></div>
</div>
</div>
</div>
</section>
<section id="convert-dataset-ke-csv">
<h3>Convert Dataset Ke CSV<a class="headerlink" href="#convert-dataset-ke-csv" title="Link to this heading">#</a></h3>
<p>Setelah melakukan pembacaan data dari step Import data dari Python, dilakukan konversi dataset tersebut ke dalam ekstensi .csv. Hal ini dilakukan agar memudahkan pembacaan data dan melakukan langkah-langkah selanjutnya dengan baik. Code convert dataset ke CSV adalah sebagai berikut.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Mengubah data ke DataFrame</span>
<span class="n">data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">wholesale_customers</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">features</span><span class="p">)</span>

<span class="c1"># Menambahkan kolom target</span>
<span class="n">data_df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wholesale_customers</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">targets</span>

<span class="c1"># Menyimpan data ke file .csv</span>
<span class="n">data_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;wholesale_customers.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data wholesalecustomers telah disimpan dalam file &#39;wholesale_customers.csv&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data wholesalecustomers telah disimpan dalam file &#39;wholesale_customers.csv&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="menarik-data-dari-mysql">
<h3>Menarik Data dari Mysql<a class="headerlink" href="#menarik-data-dari-mysql" title="Link to this heading">#</a></h3>
<p>Menarik data dari MySQL merujuk pada proses mengambil atau meng-query data yang tersimpan dalam database MySQL menggunakan perangkat lunak atau bahasa pemrograman yang mendukung koneksi ke MySQL</p>
<p>Menarik data dari MySQL adalah langkah penting dalam proses analisis data, pengembangan aplikasi, dan integrasi sistem. Ini memungkinkan Anda untuk mengakses, memanipulasi, dan menganalisis data yang tersimpan dalam database MySQL dengan cara yang efisien dan efektif menggunakan alat dan bahasa pemrograman yang sesuai.</p>
<p>Terdapat penarikan data dari database MySQL dengan query sebagai berikut.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">mysql</span><span class="o">-</span><span class="n">connector</span><span class="o">-</span><span class="n">python</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>^C
Collecting mysql-connector-python
  Downloading mysql_connector_python-8.4.0-cp310-cp310-win_amd64.whl (14.5 MB)
     ---------------------------------------- 14.5/14.5 MB 1.7 MB/s eta 0:00:00
Installing collected packages: mysql-connector-python
Successfully installed mysql-connector-python-8.4.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[notice] A new release of pip available: 22.2.1 -&gt; 24.1
[notice] To update, run: python.exe -m pip install --upgrade pip
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mysql.connector</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Menghubungkan ke database MySQL</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
    <span class="n">host</span><span class="o">=</span><span class="s1">&#39;mysql-2f906079-zahfiabdillah02-c31a.a.aivencloud.com&#39;</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="mi">24909</span><span class="p">,</span>
    <span class="n">user</span><span class="o">=</span><span class="s1">&#39;avnadmin&#39;</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="s1">&#39;AVNS_sSgCr4UEqJ1X4HHzilN&#39;</span><span class="p">,</span>
    <span class="n">database</span><span class="o">=</span><span class="s1">&#39;DBzahfi&#39;</span>
<span class="p">)</span>

<span class="c1"># Menarik data menggunakan pandas</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM wholesale_customers&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>

<span class="c1"># Menampilkan beberapa baris pertama dari data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Menutup koneksi</span>
<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_43/2728469724.py:15: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  data = pd.read_sql(query, conn)
   No  Region  Fresh  Milk  Grocery  Frozen  Detergents_Paper  Delicassen  \
0   1       3  12669  9656     7561     214              2674        1338   
1   2       3   7057  9810     9568    1762              3293        1776   
2   3       3   6353  8808     7684    2405              3516        7844   
3   4       3  13265  1196     4221    6404               507        1788   
4   5       3  22615  5410     7198    3915              1777        5185   

   Channel  
0        2  
1        2  
2        2  
3        1  
4        2  
</pre></div>
</div>
</div>
</div>
</section>
<section id="visual-tiap-fitur-dataset-wholesale-customers">
<h3>Visual Tiap Fitur Dataset Wholesale Customers<a class="headerlink" href="#visual-tiap-fitur-dataset-wholesale-customers" title="Link to this heading">#</a></h3>
<p>visualisasi data tiap fitur dalam dataset wholesale Customers membantu dalam memahami karakteristik data, mengidentifikasi pola dan tren, menemukan anomali atau ketidakseimbangan, dan mendukung langkah-langkah pra-pemrosesan data serta pemilihan fitur yang relevan untuk analisis lebih lanjut atau pembangunan model pembelajaran mesin. Visualisasi ini memberikan pandangan yang komprehensif tentang data, memfasilitasi analisis yang lebih mendalam dan pengambilan keputusan yang lebih baik.</p>
<p>dataset Wholesale Customers dari file CSV ini membuat berbagai visualisasi untuk fitur-fitur dalam dataset. Visualisasi yang dibuat berbentuk Diagram untuk menampilkan distribusi frekuensi dalam setiap fitur. Visualisasi ini membantu dalam memahami distribusi data dalam dataset dan memberikan gambaran tentang karakteristik data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mysql.connector</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Menghubungkan ke database MySQL</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
    <span class="n">host</span><span class="o">=</span><span class="s1">&#39;mysql-2f906079-zahfiabdillah02-c31a.a.aivencloud.com&#39;</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="mi">24909</span><span class="p">,</span>
    <span class="n">user</span><span class="o">=</span><span class="s1">&#39;avnadmin&#39;</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="s1">&#39;AVNS_sSgCr4UEqJ1X4HHzilN&#39;</span><span class="p">,</span>
    <span class="n">database</span><span class="o">=</span><span class="s1">&#39;DBzahfi&#39;</span>
<span class="p">)</span>

<span class="c1"># Menarik data menggunakan pandas</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM wholesale_customers&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>

<span class="c1"># Menutup koneksi</span>
<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Memplot setiap kolom</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">column</span><span class="si">}</span><span class="s1"> Data&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_43/1087795206.py:16: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  data = pd.read_sql(query, conn)
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/2c9a7d8a70405a767dc107763caacb1f683a74675be4bd05fc2a77478022b315.png"><img alt="_images/2c9a7d8a70405a767dc107763caacb1f683a74675be4bd05fc2a77478022b315.png" src="_images/2c9a7d8a70405a767dc107763caacb1f683a74675be4bd05fc2a77478022b315.png" style="width: 850px; height: 547px;" /></a>
<a class="reference internal image-reference" href="_images/b2abc424685b6a6aceaee636a2785ae54348774b306a2bcb909a9ca83318e50b.png"><img alt="_images/b2abc424685b6a6aceaee636a2785ae54348774b306a2bcb909a9ca83318e50b.png" src="_images/b2abc424685b6a6aceaee636a2785ae54348774b306a2bcb909a9ca83318e50b.png" style="width: 855px; height: 547px;" /></a>
<a class="reference internal image-reference" href="_images/19ff519389127b9323c1fc4b685681b751b14df6fb57a439994ffd9b33ba2f21.png"><img alt="_images/19ff519389127b9323c1fc4b685681b751b14df6fb57a439994ffd9b33ba2f21.png" src="_images/19ff519389127b9323c1fc4b685681b751b14df6fb57a439994ffd9b33ba2f21.png" style="width: 876px; height: 547px;" /></a>
<a class="reference internal image-reference" href="_images/349cda7093d8bc8c226ca8c191e198ab0634494cd29e4bbbe7e2189697b8d872.png"><img alt="_images/349cda7093d8bc8c226ca8c191e198ab0634494cd29e4bbbe7e2189697b8d872.png" src="_images/349cda7093d8bc8c226ca8c191e198ab0634494cd29e4bbbe7e2189697b8d872.png" style="width: 868px; height: 547px;" /></a>
<a class="reference internal image-reference" href="_images/1bb338d0cb8126591b753fcff9ac4fe496350cad85b6863ce74ac248e3a807cb.png"><img alt="_images/1bb338d0cb8126591b753fcff9ac4fe496350cad85b6863ce74ac248e3a807cb.png" src="_images/1bb338d0cb8126591b753fcff9ac4fe496350cad85b6863ce74ac248e3a807cb.png" style="width: 868px; height: 547px;" /></a>
<a class="reference internal image-reference" href="_images/1de700762275e770d0b60a0c7f19a7f1deb3783d8013b399276350044fa46e40.png"><img alt="_images/1de700762275e770d0b60a0c7f19a7f1deb3783d8013b399276350044fa46e40.png" src="_images/1de700762275e770d0b60a0c7f19a7f1deb3783d8013b399276350044fa46e40.png" style="width: 868px; height: 547px;" /></a>
<a class="reference internal image-reference" href="_images/464ce1eef1299d6ab369905b29cc41fe8c486aca6860f025737d55afafdd7909.png"><img alt="_images/464ce1eef1299d6ab369905b29cc41fe8c486aca6860f025737d55afafdd7909.png" src="_images/464ce1eef1299d6ab369905b29cc41fe8c486aca6860f025737d55afafdd7909.png" style="width: 868px; height: 547px;" /></a>
<a class="reference internal image-reference" href="_images/79bde7fa61735f8f3eb6eeaf47ef851afc75b95afc6ad13494fdb28259acfe56.png"><img alt="_images/79bde7fa61735f8f3eb6eeaf47ef851afc75b95afc6ad13494fdb28259acfe56.png" src="_images/79bde7fa61735f8f3eb6eeaf47ef851afc75b95afc6ad13494fdb28259acfe56.png" style="width: 868px; height: 547px;" /></a>
<a class="reference internal image-reference" href="_images/a77db2687b3f6aad3cff907eaa7e185f14b170cac88efb3142aa44cd437007c9.png"><img alt="_images/a77db2687b3f6aad3cff907eaa7e185f14b170cac88efb3142aa44cd437007c9.png" src="_images/a77db2687b3f6aad3cff907eaa7e185f14b170cac88efb3142aa44cd437007c9.png" style="width: 846px; height: 547px;" /></a>
</div>
</div>
</section>
</section>
<section id="prepocessing-data">
<h2>Prepocessing Data<a class="headerlink" href="#prepocessing-data" title="Link to this heading">#</a></h2>
<p>Apa Itu Preprocessing Data? Preprocessing data adalah serangkaian langkah yang dilakukan pada data mentah sebelum dimasukkan ke dalam model machine learning. Tujuan utamanya adalah untuk mengubah data ke dalam format yang lebih mudah untuk dianalisis atau diproses oleh algoritma pembelajaran mesin.</p>
<p>Beberapa teknik umum dalam preprocessing data yang diimplementasikan dalam dataset ini, meliputi:</p>
<ul class="simple">
<li><p>Handling Missing Values: Mengisi nilai yang hilang atau menghapus baris/kolom dengan nilai yang hilang</p></li>
</ul>
<ul class="simple">
<li><p>Handling Outlier: Data yang memiliki nilai ekstrem atau jauh berbeda dari nilai-nilai lain dalam dataset.</p></li>
</ul>
<ul class="simple">
<li><p>Encoding Categorical Data: Mengubah data kategorikal menjadi bentuk numerik agar dapat diproses oleh model machine learning</p></li>
</ul>
<ul class="simple">
<li><p>Identifikasi KNN: Menentukan kelas atau nilai dari data baru berdasarkan kelas atau nilai dari data yang paling dekat (tetangga terdekat) di dalam dataset. (Optional/jika tidak missing values di kolom tertentu).</p></li>
</ul>
<ul class="simple">
<li><p>Data Splitting: Membagi data menjadi data pelatihan dan data uji untuk evaluasi model. -Identifikasi LOF: Proses untuk mengidentifikasi data yang tidak sesuai atau tidak mengikuti pola yang ada dalam dataset.</p></li>
</ul>
<p>Berikut ini merupakan penjelasan beserta implementasinya untuk Dataset Wholesale Customers adalah sebagai berikut.</p>
<section id="mengidentifikasi-missing-values">
<h3>Mengidentifikasi Missing Values<a class="headerlink" href="#mengidentifikasi-missing-values" title="Link to this heading">#</a></h3>
<p>Missing value, atau nilai yang hilang, adalah istilah yang digunakan dalam analisis data untuk merujuk pada entri yang tidak ada dalam dataset. Hal ini bisa terjadi karena berbagai alasan, seperti kesalahan dalam pengumpulan data, kesalahan pengisian formulir, atau data yang memang tidak tersedia. Missing value dapat berdampak signifikan pada analisis dan hasil model pembelajaran mesin jika tidak ditangani dengan benar. Metode Penanganan Missing Value, di antaranya:</p>
<ul class="simple">
<li><p>Penghapusan Data: Listwise Deletion: Menghapus seluruh baris data yang mengandung nilai yang hilang. Pairwise Deletion: Menggunakan subset data yang lengkap untuk setiap analisis.</p></li>
</ul>
<ul class="simple">
<li><p>Imputasi Data: Mean/Median/Mode Imputation: Menggantikan nilai yang hilang dengan mean, median, atau mode dari variabel tersebut. Regression Imputation: Menggunakan regresi untuk memprediksi dan mengganti nilai yang hilang. K-Nearest Neighbors (KNN) Imputation: Menggantikan nilai yang hilang dengan nilai rata-rata dari k tetangga terdekat. Penggunaan Model Kompleks:</p></li>
</ul>
<ul class="simple">
<li><p>Multiple Imputation: Menggunakan beberapa imputasi untuk menghasilkan beberapa set lengkap data, menganalisis setiap set, dan menggabungkan hasilnya.</p></li>
</ul>
<ul class="simple">
<li><p>Machine Learning Algorithms: Menggunakan algoritma pembelajaran mesin untuk memprediksi nilai yang hilang.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_1</span> <span class="o">=</span> <span class="n">_deepnote_execute_sql</span><span class="p">(</span><span class="s1">&#39;SELECT *</span><span class="se">\n</span><span class="s1">FROM DBzahfi.wholesale_customers</span><span class="se">\n</span><span class="s1">WHERE </span><span class="se">\n</span><span class="s1">    (Region IS NULL OR Region = </span><span class="se">\&#39;\&#39;</span><span class="s1">)</span><span class="se">\n</span><span class="s1">    OR (Fresh IS NULL OR Fresh = </span><span class="se">\&#39;\&#39;</span><span class="s1">)</span><span class="se">\n</span><span class="s1">    OR (Milk IS NULL OR Milk = </span><span class="se">\&#39;\&#39;</span><span class="s1">)</span><span class="se">\n</span><span class="s1">    OR (Grocery IS NULL OR Grocery = </span><span class="se">\&#39;\&#39;</span><span class="s1">)</span><span class="se">\n</span><span class="s1">    OR (Frozen IS NULL OR Frozen = </span><span class="se">\&#39;\&#39;</span><span class="s1">)</span><span class="se">\n</span><span class="s1">    OR (Detergents_Paper IS NULL OR Detergents_Paper = </span><span class="se">\&#39;\&#39;</span><span class="s1">)</span><span class="se">\n</span><span class="s1">    OR (Delicassen IS NULL OR Delicassen = </span><span class="se">\&#39;\&#39;</span><span class="s1">)</span><span class="se">\n</span><span class="s1">    OR (Channel IS NULL OR Channel = </span><span class="se">\&#39;\&#39;</span><span class="s1">)</span><span class="se">\n</span><span class="s1">    -- tambahkan kondisi untuk setiap kolom yang ingin Anda periksa</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;SQL_34238815_78FD_42ED_9097_3C2C3192D9CF&#39;</span><span class="p">,</span> <span class="n">audit_sql_comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">sql_cache_mode</span><span class="o">=</span><span class="s1">&#39;cache_disabled&#39;</span><span class="p">)</span>
<span class="n">df_1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>No</th>
      <th>Region</th>
      <th>Fresh</th>
      <th>Milk</th>
      <th>Grocery</th>
      <th>Frozen</th>
      <th>Detergents_Paper</th>
      <th>Delicassen</th>
      <th>Channel</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<p>Dari hasil yang dilakukan pada Query di atas, dapat disimpulkan bahwa tidak ada Missing Values pada dataset Wholesale Customers di atas. Jadi, Dataset Wholesale Customers dengan ketidakhadiran Missing Values menjadikan sumber data yang ideal untuk tugas klasifikasi. Hal ini memungkinkan model untuk dilatih dengan data yang lengkap dan akurat, menghasilkan prediksi yang lebih andal dan analisis data yang lebih mudah.</p>
</section>
<section id="mengidentifikasi-outlier">
<h3>Mengidentifikasi Outlier<a class="headerlink" href="#mengidentifikasi-outlier" title="Link to this heading">#</a></h3>
<p>Identifikasi outlier adalah proses untuk mengidentifikasi data yang tidak sesuai atau tidak mengikuti pola yang ada dalam dataset. Outlier dapat mempengaruhi analisis data dan hasil yang didapatkan, sehingga penting untuk mendeteksi dan menanganinya dengan benar. Ada berbagai metode untuk mengidentifikasi outlier, termasuk metode statistik dan visualisasi data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Membaca dataset</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;wholesale_customers.csv&#39;</span><span class="p">)</span>

<span class="c1"># DataFrame diubah alias ke &#39;df&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">data</span>

<span class="c1"># Identifikasi kolom tipe numerik</span>
<span class="n">numeric_columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

<span class="c1"># Analisis outlier untuk setiap kolom numerik</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">numeric_columns</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kolom numerik: </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Hitung statistik deskriptif</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Statistik deskriptif </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

    <span class="c1"># Menggunakan Z-score untuk mendeteksi outlier</span>
    <span class="n">z_scores</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">outliers_z</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">z_scores</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">]</span>

    <span class="c1"># Menggunakan IQR untuk mendeteksi outlier</span>
    <span class="n">Q1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="n">Q3</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
    <span class="n">IQR</span> <span class="o">=</span> <span class="n">Q3</span> <span class="o">-</span> <span class="n">Q1</span>
    <span class="n">outliers_iqr</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">Q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span><span class="p">))</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">Q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span><span class="p">))]</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Outlier berdasarkan Z-score (|Z| &gt; 3):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">outliers_z</span><span class="p">[[</span><span class="n">col</span><span class="p">]])</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Outlier berdasarkan IQR:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">outliers_iqr</span><span class="p">[[</span><span class="n">col</span><span class="p">]])</span>

    <span class="c1"># Visualisasi distribusi kolom numerik</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Distribusi </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">vert</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Boxplot </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kolom numerik: Channel

Statistik deskriptif Channel:
count    440.000000
mean       1.322727
std        0.468052
min        1.000000
25%        1.000000
50%        1.000000
75%        2.000000
max        2.000000
Name: Channel, dtype: float64

Outlier berdasarkan Z-score (|Z| &gt; 3):
Empty DataFrame
Columns: [Channel]
Index: []

Outlier berdasarkan IQR:
Empty DataFrame
Columns: [Channel]
Index: []
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/47634aca5aa63fa742eeecae86e0a22f7ff0603876bad28d956b0edea94565c4.png"><img alt="_images/47634aca5aa63fa742eeecae86e0a22f7ff0603876bad28d956b0edea94565c4.png" src="_images/47634aca5aa63fa742eeecae86e0a22f7ff0603876bad28d956b0edea94565c4.png" style="width: 831px; height: 451px;" /></a>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kolom numerik: Fresh

Statistik deskriptif Fresh:
count       440.000000
mean      12000.297727
std       12647.328865
min           3.000000
25%        3127.750000
50%        8504.000000
75%       16933.750000
max      112151.000000
Name: Fresh, dtype: float64

Outlier berdasarkan Z-score (|Z| &gt; 3):
      Fresh
39    56159
103   56082
125   76237
181  112151
258   56083
259   53205
284   68951

Outlier berdasarkan IQR:
      Fresh
29    43088
39    56159
47    44466
52    40721
87    43265
103   56082
125   76237
129   42312
176   45640
181  112151
239   47493
258   56083
259   53205
282   49063
284   68951
285   40254
289   42786
370   39679
377   38793
436   39228
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/1fd08bf31699bcbbb0ecfa13e7d842f17994513f6f367de3baf9a7700e19a03b.png"><img alt="_images/1fd08bf31699bcbbb0ecfa13e7d842f17994513f6f367de3baf9a7700e19a03b.png" src="_images/1fd08bf31699bcbbb0ecfa13e7d842f17994513f6f367de3baf9a7700e19a03b.png" style="width: 831px; height: 451px;" /></a>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kolom numerik: Milk

Statistik deskriptif Milk:
count      440.000000
mean      5796.265909
std       7380.377175
min         55.000000
25%       1533.000000
50%       3627.000000
75%       7190.250000
max      73498.000000
Name: Milk, dtype: float64

Outlier berdasarkan Z-score (|Z| &gt; 3):
      Milk
23   36423
47   54259
56   29892
61   38369
85   46197
86   73498
181  29627
183  43950
211  28326

Outlier berdasarkan IQR:
      Milk
23   36423
28   20484
38   15729
45   22044
47   54259
49   21412
56   29892
61   38369
65   20959
85   46197
86   73498
92   27472
109  16729
163  15726
171  25862
181  29627
183  43950
211  28326
216  16599
251  23133
254  17972
265  23527
309  20655
319  25071
325  16784
358  18664
384  21858
427  16687
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/6018ef20a9ac10f0e1ab285f606cb01604dbb740cf58211ad865b5658e9193d9.png"><img alt="_images/6018ef20a9ac10f0e1ab285f606cb01604dbb740cf58211ad865b5658e9193d9.png" src="_images/6018ef20a9ac10f0e1ab285f606cb01604dbb740cf58211ad865b5658e9193d9.png" style="width: 831px; height: 451px;" /></a>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kolom numerik: Grocery

Statistik deskriptif Grocery:
count      440.000000
mean      7951.277273
std       9503.162829
min          3.000000
25%       2153.000000
50%       4755.500000
75%      10655.750000
max      92780.000000
Name: Grocery, dtype: float64

Outlier berdasarkan Z-score (|Z| &gt; 3):
     Grocery
47     55571
61     59598
65     45828
85     92780
211    39694
216    36486
333    67298

Outlier berdasarkan IQR:
     Grocery
28     25957
43     23998
47     55571
49     28921
56     26866
61     59598
65     45828
77     28540
85     92780
86     32114
92     32034
109    28986
145    34792
163    26870
201    24708
205    23596
211    39694
216    36486
251    33586
304    24773
331    26839
333    67298
343    26316
437    30243
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/49cd0ede99295781f90e4fa72665074e753fe2ac4c100b4c1cb059cde4f06d18.png"><img alt="_images/49cd0ede99295781f90e4fa72665074e753fe2ac4c100b4c1cb059cde4f06d18.png" src="_images/49cd0ede99295781f90e4fa72665074e753fe2ac4c100b4c1cb059cde4f06d18.png" style="width: 831px; height: 451px;" /></a>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kolom numerik: Frozen

Statistik deskriptif Frozen:
count      440.000000
mean      3071.931818
std       4854.673333
min         25.000000
25%        742.250000
50%       1526.000000
75%       3554.250000
max      60869.000000
Name: Frozen, dtype: float64

Outlier berdasarkan Z-score (|Z| &gt; 3):
     Frozen
93    35009
103   18028
183   36534
196   18711
325   60869
413   17866

Outlier berdasarkan IQR:
     Frozen
22     9408
39    10002
40     9510
47     7782
70    10643
72     8872
73     8132
88     9735
91     8693
93    35009
103   18028
112    8853
125   16538
126    8195
143    8425
181   16745
183   36534
195    7888
196   18711
230    8321
240   11422
265   10155
277   16919
283   10303
284    8692
287    8366
310   12569
325   60869
328    7849
334   11559
337    8170
338   15601
339    9584
371    8164
381    9927
393    8620
401   13223
406    9806
413   17866
425   15348
427   15082
431   13486
435   13135
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/cd1df34cf5cb0d2865c551a3ed170cd914b7ee5bd413ab9140f46b17f9bc1842.png"><img alt="_images/cd1df34cf5cb0d2865c551a3ed170cd914b7ee5bd413ab9140f46b17f9bc1842.png" src="_images/cd1df34cf5cb0d2865c551a3ed170cd914b7ee5bd413ab9140f46b17f9bc1842.png" style="width: 832px; height: 451px;" /></a>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kolom numerik: Detergents_Paper

Statistik deskriptif Detergents_Paper:
count      440.000000
mean      2881.493182
std       4767.854448
min          3.000000
25%        256.750000
50%        816.500000
75%       3922.000000
max      40827.000000
Name: Detergents_Paper, dtype: float64

Outlier berdasarkan Z-score (|Z| &gt; 3):
     Detergents_Paper
47              24171
56              17740
61              26701
65              24231
85              40827
86              20070
92              18906
211             19410
251             18594
333             38102

Outlier berdasarkan IQR:
     Detergents_Paper
43               9529
47              24171
49              13583
56              17740
61              26701
65              24231
77              12034
85              40827
86              20070
92              18906
145             12591
155             11577
163             13726
173              9836
200              9959
201             14235
209             12420
211             19410
216             13308
251             18594
303             10069
304             11783
312             17120
319             12408
331              9606
333             38102
343             15469
349             12218
351             12638
437             14841
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/1cea709e2a4b54a9cf10bb80e9c7877606b364d221f84c5e38eb7823018c9bc2.png"><img alt="_images/1cea709e2a4b54a9cf10bb80e9c7877606b364d221f84c5e38eb7823018c9bc2.png" src="_images/1cea709e2a4b54a9cf10bb80e9c7877606b364d221f84c5e38eb7823018c9bc2.png" style="width: 831px; height: 451px;" /></a>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kolom numerik: Delicassen

Statistik deskriptif Delicassen:
count      440.000000
mean      1524.870455
std       2820.105937
min          3.000000
25%        408.250000
50%        965.500000
75%       1820.250000
max      47943.000000
Name: Delicassen, dtype: float64

Outlier berdasarkan Z-score (|Z| &gt; 3):
     Delicassen
23        16523
71        14472
87        14351
183       47943

Outlier berdasarkan IQR:
     Delicassen
2          7844
4          5185
17         4478
22         4334
23        16523
24         5778
28         5206
36         4626
40         5864
45         4985
47         6465
71        14472
87        14351
92         5130
145        4430
171        6250
181        8550
183       47943
202        6854
218        6372
251        5121
325        5609
358        4100
372        4829
384        5120
409        5137
411        4365
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/eba4c0837606af35dd0e40da4bb38073115def148bb4a35dd9039c235fc84d09.png"><img alt="_images/eba4c0837606af35dd0e40da4bb38073115def148bb4a35dd9039c235fc84d09.png" src="_images/eba4c0837606af35dd0e40da4bb38073115def148bb4a35dd9039c235fc84d09.png" style="width: 850px; height: 451px;" /></a>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kolom numerik: target

Statistik deskriptif target:
count    440.000000
mean       2.543182
std        0.774272
min        1.000000
25%        2.000000
50%        3.000000
75%        3.000000
max        3.000000
Name: target, dtype: float64

Outlier berdasarkan Z-score (|Z| &gt; 3):
Empty DataFrame
Columns: [target]
Index: []

Outlier berdasarkan IQR:
Empty DataFrame
Columns: [target]
Index: []
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/fbc46c7343ae187a01ef211c9ef93f8a8153362d42c8f765333ac28817e4a0e5.png"><img alt="_images/fbc46c7343ae187a01ef211c9ef93f8a8153362d42c8f765333ac28817e4a0e5.png" src="_images/fbc46c7343ae187a01ef211c9ef93f8a8153362d42c8f765333ac28817e4a0e5.png" style="width: 831px; height: 451px;" /></a>
</div>
</div>
<p>Berdasarkan analisis outlier yang dilakukan terhadap tujuh fitur numerik, tidak ditemukan adanya outlier yang signifikan pada dataset.</p>
<p>Hal ini dapat disimpulkan dari beberapa poin berikut:</p>
<p>Distribusi Kategori: Frekuensi kategori untuk setiap fitur menunjukkan distribusi yang wajar dan tidak ada kenaikan melonjak pada kategori individu. Ini menunjukkan bahwa tidak ada data yang jauh melampaui nilai-nilai yang diharapkan.</p>
<p>Visualisasi Distribusi: Histogram untuk setiap fitur menampilkan distribusi data yang relatif normal tanpa adanya suatu data yang menonjol.</p>
<p>Oleh karena itu, dapat disimpulkan bahwa dataset tidak mengandung outlier pada fitur numerik dalam dataset Wholesale Customers. Hal ini memungkinkan untuk melanjutkan analisis data tanpa perlu melakukan koreksi atau pemindahan outlier.</p>
</section>
<section id="encoding-data">
<h3>Encoding Data<a class="headerlink" href="#encoding-data" title="Link to this heading">#</a></h3>
<p>Untuk split dataset yang digunakan proyek ini, terdapat dalam sub-bab bagian Mengidentifikasi KNN . Hal ini dilakukan karena tahap tersebut berkaitan dengan split dataset. Jadinya, peletakan code implementasi ini tidak disampaikan pada bagian ini.</p>
<p>Hal ini mempersiapkan data untuk analisis lebih lanjut atau untuk dimasukkan ke dalam model pembelajaran mesin. Pra-pemrosesan data yang baik adalah langkah penting dalam memastikan bahwa model yang dibangun dari data tersebut dapat memberikan hasil yang akurat dan bermakna</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>

<span class="c1"># Preprocess data</span>
<span class="c1"># Convert ordinal attributes to numerical values using LabelEncoder</span>
<span class="n">le_Channel</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">le_Fresh</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">le_Milk</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">le_Grocery</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">le_Frozen</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">le_Detergents_Paper</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">le_Delicassen</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>

<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Channel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le_Channel</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Channel&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Fresh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le_Fresh</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Fresh&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Milk&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le_Milk</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Milk&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Grocery&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le_Grocery</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Grocery&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Frozen&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le_Frozen</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Frozen&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Detergents_Paper&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le_Detergents_Paper</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Detergents_Paper&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Delicassen&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le_Delicassen</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Delicassen&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Channel&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Fresh&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Milk&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Grocery&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Frozen&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Detergents_Paper&quot;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Delicassen&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      1
1      1
2      1
3      0
4      1
      ..
435    0
436    0
437    1
438    0
439    0
Name: Channel, Length: 440, dtype: int64 0      285
1      190
2      179
3      291
4      369
      ... 
435    396
436    414
437    302
438    246
439     92
Name: Fresh, Length: 440, dtype: int64 0      349
1      353
2      341
3       73
4      265
      ... 
435    375
436     91
437    392
438    130
439    109
Name: Milk, Length: 440, dtype: int64 0      276
1      306
2      280
3      196
4      270
      ... 
435    374
436     18
437    418
438    112
439    130
Name: Grocery, Length: 440, dtype: int64 0       31
1      227
2      267
3      372
4      327
      ... 
435    411
436    341
437     67
438    154
439      8
Name: Frozen, Length: 440, dtype: int64 0      276
1      286
2      294
3      159
4      253
      ... 
435     63
436     34
437    404
438     56
439    155
Name: Detergents_Paper, Length: 440, dtype: int64 0      240
1      289
2      397
3      292
4      388
      ... 
435    324
436    331
437    300
438    315
439     11
Name: Delicassen, Length: 440, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>

<span class="c1"># Load data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers.csv&quot;</span><span class="p">)</span>

<span class="c1"># Convert ordinal attributes to numerical values using LabelEncoder</span>
<span class="n">le_Channel</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">le_Fresh</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">le_Milk</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">le_Grocery</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">le_Frozen</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">le_Detergents_Paper</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">le_Delicassen</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>

<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Channel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le_Channel</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Channel&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Fresh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le_Fresh</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Fresh&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Milk&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le_Milk</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Milk&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Grocery&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le_Grocery</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Grocery&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Frozen&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le_Frozen</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Frozen&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Detergents_Paper&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le_Detergents_Paper</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Detergents_Paper&quot;</span><span class="p">])</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;Delicassen&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">le_Delicassen</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Delicassen&quot;</span><span class="p">])</span>

<span class="n">encoded_filename</span> <span class="o">=</span> <span class="s2">&quot;wholesale_customers-encoded.csv&quot;</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">encoded_filename</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Save without index</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Encoded data saved to: </span><span class="si">{</span><span class="n">encoded_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Encoded data saved to: wholesale_customers-encoded.csv
</pre></div>
</div>
</div>
</div>
</section>
<section id="mengidentifikasi-algoritma-knn">
<h3>Mengidentifikasi Algoritma KNN<a class="headerlink" href="#mengidentifikasi-algoritma-knn" title="Link to this heading">#</a></h3>
<p>Algoritma KNN adalah salah satu algoritma yang digunakan dalam pembelajaran mesin untuk masalah klasifikasi dan regresi. Ide dasar di balik algoritma ini adalah bahwa sebuah objek akan lebih cenderung memiliki label yang sama dengan tetangga terdekatnya dalam ruang fitur.</p>
<p>Algoritma KNN membutuhkan penyimpanan seluruh dataset dalam memprediksi label objek baru, sehingga dapat membutuhkan banyak memori terutama untuk dataset besar. Selain itu, penggunaan K yang tidak tepat dapat mempengaruhi kinerja algoritma, karena nilai K yang terlalu kecil dapat membuat model menjadi terlalu sensitif terhadap noise, sementara nilai K yang terlalu besar dapat menyebabkan model menjadi terlalu kasar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mysql.connector</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">classification_report</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
    <span class="n">host</span><span class="o">=</span><span class="s1">&#39;mysql-2f906079-zahfiabdillah02-c31a.a.aivencloud.com&#39;</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="mi">24909</span><span class="p">,</span>
    <span class="n">user</span><span class="o">=</span><span class="s1">&#39;avnadmin&#39;</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="s1">&#39;AVNS_sSgCr4UEqJ1X4HHzilN&#39;</span><span class="p">,</span>
    <span class="n">database</span><span class="o">=</span><span class="s1">&#39;DBzahfi&#39;</span>
<span class="p">)</span>

<span class="c1"># Menarik data menggunakan pandas</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM wholesale_customers&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>

<span class="c1"># Drop the &#39;No&#39; column</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">])</span>

<span class="c1"># Separate features and target</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Channel&#39;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Channel&#39;</span><span class="p">]</span>

<span class="c1"># Split the data into training and testing sets</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------- data X_train -----------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_train</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;wholesale_customers-Xtrain.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------- data X_test -----------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">X_test</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;wholesale_customers-Xtest.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------- data y_train -----------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_train</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;wholesale_customers-ytrain.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------- data y_test -----------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
<span class="n">y_test</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;wholesale_customers-ytest.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Normalize the features</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Train the KNN model</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># You can change the number of neighbors</span>
<span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Predict on the test set</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>

<span class="c1"># Evaluate the model</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="c1"># Print the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Classification Report:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_41/2534881891.py:18: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  data = pd.read_sql(query, conn)
----------- data X_train -----------
     Region  Fresh   Milk  Grocery  Frozen  Detergents_Paper  Delicassen
266       1    572   9763    22182    2221              4882        2563
294       2  21273   2013     6550     909               811        1854
31        3   2612   4339     3133    2088               820         985
84        3  11867   3327     4814    1178              3837         120
301       2   5283  13316    20399    1809              8752         172
..      ...    ...    ...      ...     ...               ...         ...
106       3   1454   6337    10704     133              6830        1831
270       1   4720   1032      975    5500               197          56
348       3   3428   2380     2028    1341              1184         665
435       3  29703  12051    16027   13135               182        2204
102       3   2932   6459     7677    2561              4573        1386

[352 rows x 7 columns]
----------- data X_test -----------
     Region  Fresh   Milk  Grocery  Frozen  Detergents_Paper  Delicassen
265       1   5909  23527    13699   10155               830        3636
78        3  10766   1175     2067    2096               301         167
347       3  27380   7184    12311    2809              4621        1022
255       1  31614    489     1495    3242               111         615
327       2    542    899     1664     414                88         522
..      ...    ...    ...      ...     ...               ...         ...
57        3   5417   9933    10487      38              7572        1282
137       3   3087   8080     8282     661               721          36
24        3  22647   9776    13792    2915              4482        5778
17        3   5876   6157     2933     839               370        4478
66        3      9   1534     7417     175              3468          27

[88 rows x 7 columns]
----------- data y_train -----------
266    2
294    1
31     1
84     2
301    2
      ..
106    2
270    1
348    1
435    1
102    2
Name: Channel, Length: 352, dtype: int64
----------- data y_test -----------
265    1
78     1
347    2
255    1
327    1
      ..
57     2
137    1
24     2
17     1
66     1
Name: Channel, Length: 88, dtype: int64
Accuracy: 88.64%
Classification Report:
              precision    recall  f1-score   support

           1       0.97      0.88      0.92        65
           2       0.72      0.91      0.81        23

    accuracy                           0.89        88
   macro avg       0.85      0.89      0.86        88
weighted avg       0.90      0.89      0.89        88
</pre></div>
</div>
</div>
</div>
</section>
<section id="mengidentifikasi-lof">
<h3>Mengidentifikasi LOF<a class="headerlink" href="#mengidentifikasi-lof" title="Link to this heading">#</a></h3>
<p>LRD tiap titik digunakan untuk membandingkan dengan rata-rata LRD K tetangganya. LOF adalah perbandingan rata-rata LRD K tetangga A terhadap LRD A.</p>
<p>Jika suatu titik bukan merupakan pencilan (inlier), rasio rata-rata LRD tetangganya kira-kira sama dengan LRD suatu titik (karena kepadatan suatu titik dan tetangganya kira-kira sama). Dalam hal ini, LOF hampir sama dengan 1. Sebaliknya, jika suatu titik merupakan outlier, LRD suatu titik lebih kecil dari rata-rata LRD tetangganya. Maka nilai LOF akan tinggi.</p>
<p>Umumnya jika LOF &gt; 1 maka dianggap outlier, namun hal tersebut tidak selalu benar. Katakanlah kita mengetahui bahwa kita hanya memiliki satu outlier dalam data, lalu kita ambil nilai LOF maksimum di antara semua nilai LOF, dan titik yang sesuai dengan nilai LOF maksimum akan dianggap sebagai outlier.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mysql.connector</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">LocalOutlierFactor</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">conn</span> <span class="o">=</span> <span class="n">mysql</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
    <span class="n">host</span><span class="o">=</span><span class="s1">&#39;mysql-2f906079-zahfiabdillah02-c31a.a.aivencloud.com&#39;</span><span class="p">,</span>
    <span class="n">port</span><span class="o">=</span><span class="mi">24909</span><span class="p">,</span>
    <span class="n">user</span><span class="o">=</span><span class="s1">&#39;avnadmin&#39;</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="s1">&#39;AVNS_sSgCr4UEqJ1X4HHzilN&#39;</span><span class="p">,</span>
    <span class="n">database</span><span class="o">=</span><span class="s1">&#39;DBzahfi&#39;</span>
<span class="p">)</span>

<span class="c1"># Menarik data menggunakan pandas</span>
<span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM wholesale_customers&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>

<span class="c1"># Drop the &#39;No&#39; column</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;No&#39;</span><span class="p">])</span>

<span class="c1"># Separate features and target</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Channel&#39;</span><span class="p">])</span>

<span class="c1"># Normalize the features</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Apply LOF</span>
<span class="n">lof</span> <span class="o">=</span> <span class="n">LocalOutlierFactor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">contamination</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># You can adjust parameters</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lof</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)</span>
<span class="n">lof_scores</span> <span class="o">=</span> <span class="o">-</span><span class="n">lof</span><span class="o">.</span><span class="n">negative_outlier_factor_</span>

<span class="c1"># Add the LOF scores and predictions to the dataframe</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;LOF_Score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lof_scores</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Outlier&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>

<span class="c1"># Display the outliers</span>
<span class="n">outliers</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Outlier&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">non_outliers</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Outlier&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Outliers detected:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outliers</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of outliers detected: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">outliers</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Non-outliers:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">non_outliers</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of non-outliers: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">non_outliers</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Save the results to a new CSV file</span>
<span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;Wholesale_customers_with_LOF.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_41/1898216433.py:17: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  data = pd.read_sql(query, conn)
Outliers detected:
     Region   Fresh   Milk  Grocery  Frozen  Detergents_Paper  Delicassen  \
2         3    6353   8808     7684    2405              3516        7844   
23        3   26373  36423    22019    5154              4337       16523   
39        3   56159    555      902   10002               212        2916   
47        3   44466  54259    55571    7782             24171        6465   
56        3    4098  29892    26866    2616             17740        1340   
61        3   35942  38369    59598    3254             26701        2017   
65        3      85  20959    45828      36             24231        1423   
68        3    2446   7260     3993    5870               788        3095   
71        3   18291   1266    21042    5373              4173       14472   
85        3   16117  46197    92780    1026             40827        2944   
86        3   22925  73498    32114     987             20070         903   
87        3   43265   5025     8117    6312              1579       14351   
93        3   11314   3090     2062   35009                71        2698   
103       3   56082   3504     8906   18028              1480        2498   
109       3    1406  16729    28986     673               836           3   
125       3   76237   3473     7102   16538               778         918   
145       3   22039   8384    34792      42             12591        4430   
171       3     200  25862    19816     651              8773        6250   
181       3  112151  29627    18148   16745              4948        8550   
183       3   36847  43950    20170   36534               239       47943   
196       1   30624   7209     4897   18711               763        2876   
202       1   25203  11487     9490    5065               284        6854   
211       1   12119  28326    39694    4736             19410        2870   
218       1      18   7504    15205    1285              4797        6372   
239       1   47493   2567     3779    5243               828        2253   
251       1    6134  23133    33586    6746             18594        5121   
253       1   29526   7961    16966     432               363        1391   
254       1   10379  17972     4748    4686              1547        3265   
258       1   56083   4563     2124    6422               730        3321   
259       1   53205   4959     7336    3012               967         818   
265       1    5909  23527    13699   10155               830        3636   
277       3    9061    829      683   16919               621         139   
284       3   68951   4411    12609    8692               751        2406   
325       2   32717  16784    13626   60869              1272        5609   
333       2    8565   4980    67298     131             38102        1215   
338       2       3    333     7021   15601                15         550   
358       3     759  18664     1660    6114               536        4100   
372       3    3884   3801     1641     876               397        4829   
384       3   10683  21858    15400    3635               282        5120   
403       3   25606  11006     4604     127               632         288   
411       3    2126   3289     3281    1535               235        4365   
413       3    4983   4859     6633   17866               912        2435   
427       3   31012  16687     5429   15082               439        1163   
435       3   29703  12051    16027   13135               182        2204   

     Channel  LOF_Score  Outlier  
2          2   1.864206       -1  
23         2   2.616468       -1  
39         1   1.572802       -1  
47         2   2.555354       -1  
56         2   1.646852       -1  
61         2   2.256476       -1  
65         2   1.809855       -1  
68         1   1.619558       -1  
71         1   3.233172       -1  
85         2   3.291427       -1  
86         2   2.979043       -1  
87         1   2.969873       -1  
93         1   3.171566       -1  
103        1   1.956896       -1  
109        2   2.008345       -1  
125        1   2.174639       -1  
145        2   1.720855       -1  
171        2   1.763077       -1  
181        1   3.572309       -1  
183        1   5.851910       -1  
196        1   1.925744       -1  
202        1   1.822646       -1  
211        2   1.706504       -1  
218        2   1.558018       -1  
239        1   1.737100       -1  
251        2   1.600526       -1  
253        1   1.681767       -1  
254        1   1.743434       -1  
258        1   1.832964       -1  
259        1   1.843195       -1  
265        1   1.772876       -1  
277        1   1.575753       -1  
284        1   1.792277       -1  
325        1   5.272760       -1  
333        2   2.848197       -1  
338        1   1.616741       -1  
358        1   2.148420       -1  
372        1   1.722907       -1  
384        1   1.940392       -1  
403        1   1.613526       -1  
411        1   1.733573       -1  
413        1   1.702170       -1  
427        1   1.921121       -1  
435        1   1.742303       -1  
Number of outliers detected: 44

Non-outliers:
     Region  Fresh   Milk  Grocery  Frozen  Detergents_Paper  Delicassen  \
0         3  12669   9656     7561     214              2674        1338   
1         3   7057   9810     9568    1762              3293        1776   
3         3  13265   1196     4221    6404               507        1788   
4         3  22615   5410     7198    3915              1777        5185   
5         3   9413   8259     5126     666              1795        1451   
..      ...    ...    ...      ...     ...               ...         ...   
434       3  16731   3922     7994     688              2371         838   
436       3  39228   1431      764    4510                93        2346   
437       3  14531  15488    30243     437             14841        1867   
438       3  10290   1981     2232    1038               168        2125   
439       3   2787   1698     2510      65               477          52   

     Channel  LOF_Score  Outlier  
0          2   1.025187        1  
1          2   1.011539        1  
3          1   1.162586        1  
4          2   1.253854        1  
5          2   1.140767        1  
..       ...        ...      ...  
434        1   1.145089        1  
436        1   1.116510        1  
437        2   1.384105        1  
438        1   1.254577        1  
439        1   1.032641        1  

[396 rows x 10 columns]
Number of non-outliers: 396
</pre></div>
</div>
</div>
</div>
</section>
<section id="klasifikasi-naive-bayes">
<h3>Klasifikasi Naive Bayes<a class="headerlink" href="#klasifikasi-naive-bayes" title="Link to this heading">#</a></h3>
<p>Klasifikasi naive bayes adalah metode pengklasifikasian probabilistik yang menggunakan teorema bayes untuk memprediksi kelas atau label data yang diberikan . metode ini menggunakan probabilitas untuk memodelkan distribusi masukan dalam kelas atau kategori tertentu</p>
<p>data yang kita riset menggunakan atau bertipe string dan untuk klasifikasi naive bayes kita rubah menjadi numerik dengan cara menggunakan LabelEncoder untuk mengubah string menjadi numerik.</p>
<p>data yang kita riset mempunyai 440 baris dan 8 kolom kita akan bagi lagi menjadi bagian x train menjadi 352 baris dan 7 kolom</p>
<p>digunakannya gaussian naive bayes pada kode dibawah untuk menghitung probabilitas posterior dari setiap kelas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">classification_report</span>

<span class="c1"># Load the dataset</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;wholesale_customers.csv&#39;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

<span class="c1"># Separate features and target</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Channel&#39;</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Channel&#39;</span><span class="p">]</span>

<span class="c1"># Split the data into training and testing sets</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Normalize the features</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Train the Naive Bayes model</span>
<span class="n">nb</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">nb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Predict on the test set</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">nb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>

<span class="c1"># Evaluate the model</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="c1"># Print the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Classification Report:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>

<span class="c1"># New data point for prediction</span>
<span class="n">new_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Region&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span>
    <span class="s1">&#39;Fresh&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20000</span><span class="p">],</span>
    <span class="s1">&#39;Milk&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">15000</span><span class="p">],</span>
    <span class="s1">&#39;Grocery&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">12000</span><span class="p">],</span>
    <span class="s1">&#39;Frozen&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5000</span><span class="p">],</span>
    <span class="s1">&#39;Detergents_Paper&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8000</span><span class="p">],</span>
    <span class="s1">&#39;Delicassen&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3000</span><span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Normalize the new data point</span>
<span class="n">new_data_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>

<span class="c1"># Predict the channel for the new data point</span>
<span class="n">new_prediction</span> <span class="o">=</span> <span class="n">nb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">new_data_scaled</span><span class="p">)</span>

<span class="c1"># Print the prediction result</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Prediction for the new data point:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Predicted Channel: </span><span class="si">{</span><span class="n">new_prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 90.91%
Classification Report:
              precision    recall  f1-score   support

           1       0.94      0.94      0.94        65
           2       0.83      0.83      0.83        23

    accuracy                           0.91        88
   macro avg       0.88      0.88      0.88        88
weighted avg       0.91      0.91      0.91        88

Prediction for the new data point:
Predicted Channel: 1
/shared-libs/python3.9/py/lib/python3.9/site-packages/sklearn/base.py:493: FutureWarning: The feature names should match those that were passed during fit. Starting version 1.2, an error will be raised.
Feature names unseen at fit time:
- Region
Feature names seen at fit time, yet now missing:
- target

  warnings.warn(message, FutureWarning)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="modeling-dataset">
<h2>Modeling Dataset<a class="headerlink" href="#modeling-dataset" title="Link to this heading">#</a></h2>
<p>Modeling dataset adalah proses membangun model matematika atau komputasi untuk memahami dan membuat prediksi berdasarkan data. Dalam konteks pembelajaran mesin dan analisis data, modeling dataset melibatkan berbagai langkah, mulai dari pemahaman data, prapemrosesan data, pemilihan model, pelatihan model, hingga evaluasi kinerja model.</p>
<section id="ensemble-learning-stacking">
<h3>Ensemble Learning - Stacking<a class="headerlink" href="#ensemble-learning-stacking" title="Link to this heading">#</a></h3>
<p>Metode stacking adalah teknik ensemble yang melibatkan penggunaan model meta-learner yang digunakan untuk menggabungkan hasil prediksi dari berbagai model-machine learning yang berbeda. Prosesnya adalah sebagai berikut:</p>
<p>Misal Kita memiliki beberapa model pembelajaran mesin yang berbeda, seperti Classifier A, Classifier B, dan Classifier C. Setiap model ini memberikan prediksi mereka terhadap data yang sama. Hasil prediksi dari masing-masing model digunakan sebagai fitur atau input untuk model “meta-learner.” Model meta-learner ini kemudian dilatih untuk menghasilkan prediksi akhir berdasarkan hasil prediksi dari model-model awal sebagai input.</p>
<p>Metode stacking membantu menggabungkan kekuatan berbagai model-machine learning dengan menggunakan model tambahan berupa meta-learner yang memutuskan hasil akhir berdasarkan apa yang dikatakan oleh model-model awal.</p>
<p>Berikut ini merupakan implementasi dari Ensamble Learning - Stacking untuk Wholesale Customers Dataset adalah sebagai berikut.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Load features (X) from &#39;wholesale_customers-Xtrain.csv&#39;</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-Xtrain.csv&quot;</span><span class="p">)</span>

<span class="c1"># Load target variable (y) from &#39;wholesale_customers-ytrain.csv&#39;</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-ytrain.csv&quot;</span><span class="p">)[</span><span class="s2">&quot;Channel&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>mlxtend
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting mlxtend
  Downloading mlxtend-0.23.1-py3-none-any.whl (1.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">1.4/1.4 MB</span> <span class=" -Color -Color-Red">58.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: pandas&gt;=0.24.2 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (2.1.4)
Requirement already satisfied: joblib&gt;=0.13.2 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (1.2.0)
Requirement already satisfied: matplotlib&gt;=3.0.0 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (3.6.0)
Requirement already satisfied: scikit-learn&gt;=1.0.2 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (1.1.2)
Requirement already satisfied: scipy&gt;=1.2.1 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (1.9.3)
Requirement already satisfied: numpy&gt;=1.16.2 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from mlxtend) (1.23.4)
Requirement already satisfied: packaging&gt;=20.0 in /shared-libs/python3.9/py-core/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (21.3)
Requirement already satisfied: pyparsing&gt;=2.2.1 in /shared-libs/python3.9/py-core/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (3.0.9)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (1.4.4)
Requirement already satisfied: fonttools&gt;=4.22.0 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (4.37.4)
Requirement already satisfied: python-dateutil&gt;=2.7 in /shared-libs/python3.9/py-core/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (2.8.2)
Requirement already satisfied: contourpy&gt;=1.0.1 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (1.0.5)
Requirement already satisfied: cycler&gt;=0.10 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (0.11.0)
Requirement already satisfied: pillow&gt;=6.2.0 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from matplotlib&gt;=3.0.0-&gt;mlxtend) (9.2.0)
Requirement already satisfied: tzdata&gt;=2022.1 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from pandas&gt;=0.24.2-&gt;mlxtend) (2022.5)
Requirement already satisfied: pytz&gt;=2020.1 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from pandas&gt;=0.24.2-&gt;mlxtend) (2022.5)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /shared-libs/python3.9/py/lib/python3.9/site-packages (from scikit-learn&gt;=1.0.2-&gt;mlxtend) (3.1.0)
Requirement already satisfied: six&gt;=1.5 in /shared-libs/python3.9/py-core/lib/python3.9/site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib&gt;=3.0.0-&gt;mlxtend) (1.16.0)
Installing collected packages: mlxtend
Successfully installed mlxtend-0.23.1

<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">23.0.1</span> -&gt; <span class=" -Color -Color-Green">24.1</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
</div>
</div>
<p>Untuk Classifiers KNN k = 3 (clf1) dan k = 5 (clf2)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span> 
<span class="kn">from</span> <span class="nn">mlxtend.classifier</span> <span class="kn">import</span> <span class="n">StackingClassifier</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="n">clf1</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">clf2</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">sclf</span> <span class="o">=</span> <span class="n">StackingClassifier</span><span class="p">(</span><span class="n">classifiers</span><span class="o">=</span><span class="p">[</span><span class="n">clf1</span><span class="p">,</span> <span class="n">clf2</span><span class="p">],</span> <span class="n">meta_classifier</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>

<span class="k">for</span> <span class="n">clf</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">clf1</span><span class="p">,</span> <span class="n">clf2</span><span class="p">,</span> <span class="n">sclf</span><span class="p">],</span> 
                      <span class="p">[</span><span class="s1">&#39;KNN [k=3]&#39;</span><span class="p">,</span> 
                       <span class="s1">&#39;KNN [k=5]&#39;</span><span class="p">,</span> 
                       <span class="s1">&#39;StackingClassifier&#39;</span><span class="p">]):</span>

    <span class="n">scores</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
                                              <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy: </span><span class="si">%0.2f</span><span class="s2"> (+/- </span><span class="si">%0.2f</span><span class="s2">) [</span><span class="si">%s</span><span class="s2">]&quot;</span> 
          <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="n">label</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 0.90 (+/- 0.03) [KNN [k=3]]
Accuracy: 0.90 (+/- 0.04) [KNN [k=5]]
Accuracy: 0.90 (+/- 0.04) [StackingClassifier]
</pre></div>
</div>
</div>
</div>
<p>Untuk Classifiers KNN k = 3 (clf1) dan Naive Bayes (clf2)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span> 
<span class="kn">from</span> <span class="nn">mlxtend.classifier</span> <span class="kn">import</span> <span class="n">StackingClassifier</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="n">clf1</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">clf2</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">sclf</span> <span class="o">=</span> <span class="n">StackingClassifier</span><span class="p">(</span><span class="n">classifiers</span><span class="o">=</span><span class="p">[</span><span class="n">clf1</span><span class="p">,</span> <span class="n">clf2</span><span class="p">],</span> <span class="n">meta_classifier</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>

<span class="k">for</span> <span class="n">clf</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">clf1</span><span class="p">,</span> <span class="n">clf2</span><span class="p">,</span> <span class="n">sclf</span><span class="p">],</span> 
                      <span class="p">[</span><span class="s1">&#39;KNN [k=3]&#39;</span><span class="p">,</span> 
                       <span class="s1">&#39;Naive Bayes&#39;</span><span class="p">,</span> 
                       <span class="s1">&#39;StackingClassifier&#39;</span><span class="p">]):</span>

    <span class="n">scores</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
                                              <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy: </span><span class="si">%0.2f</span><span class="s2"> (+/- </span><span class="si">%0.2f</span><span class="s2">) [</span><span class="si">%s</span><span class="s2">]&quot;</span> 
          <span class="o">%</span> <span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="n">label</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 0.90 (+/- 0.03) [KNN [k=3]]
Accuracy: 0.89 (+/- 0.03) [Naive Bayes]
Accuracy: 0.90 (+/- 0.03) [StackingClassifier]
</pre></div>
</div>
</div>
</div>
</section>
<section id="base-classifier">
<h3>Base Classifier<a class="headerlink" href="#base-classifier" title="Link to this heading">#</a></h3>
<p>Base classifier adalah model pembelajaran mesin dasar yang digunakan sebagai komponen individu dalam metode ensemble, seperti bagging, boosting, atau stacking. Metode ensemble ini menggabungkan beberapa base classifier untuk meningkatkan kinerja prediktif keseluruhan.</p>
<p>Base classifier adalah komponen penting dalam teknik ensemble yang membantu meningkatkan kinerja model pembelajaran mesin dengan menggabungkan kekuatan beberapa model sederhana. Meskipun kemampuan individualnya terbatas, ketika digabungkan, base classifier dapat menghasilkan model yang lebih kuat dan akurat.</p>
<p>Base classifier dalam kode ini adalah model KNN dengan jumlah tetangga berbeda (3 dan 5). Stacking classifier menggabungkan dua base classifier ini dan menggunakan model Naive Bayes sebagai meta-classifier untuk membuat prediksi akhir yang diharapkan lebih akurat. Validasi silang digunakan untuk mengevaluasi kinerja masing-masing model, dan hasilnya disimpan ke file CSV.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span> 
<span class="kn">from</span> <span class="nn">mlxtend.classifier</span> <span class="kn">import</span> <span class="n">StackingClassifier</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">clf1</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">clf2</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">sclf</span> <span class="o">=</span> <span class="n">StackingClassifier</span><span class="p">(</span><span class="n">classifiers</span><span class="o">=</span><span class="p">[</span><span class="n">clf1</span><span class="p">,</span> <span class="n">clf2</span><span class="p">],</span> <span class="n">meta_classifier</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>

<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">clf1</span><span class="p">,</span> <span class="n">clf2</span><span class="p">,</span> <span class="n">sclf</span><span class="p">]</span>
<span class="n">model_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;KNN (n_neighbors=3)&#39;</span><span class="p">,</span> <span class="s1">&#39;KNN (n_neighbors=5)&#39;</span><span class="p">,</span> <span class="s1">&#39;StackingClassifier&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">clf</span><span class="p">,</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">model_names</span><span class="p">):</span>
  <span class="c1"># Melakukan validasi silang dan menghitung akurasi</span>
  <span class="n">scores</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
  <span class="n">accuracy</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
  <span class="n">std</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

  <span class="c1"># Menyimpan hasilnya ke .csv</span>
  <span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Model&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">model_name</span><span class="p">],</span> <span class="s1">&#39;Accuracy&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">accuracy</span><span class="p">],</span> <span class="s1">&#39;Std&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">std</span><span class="p">]})</span>
  <span class="n">results_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">_results.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

  <span class="c1"># Mencetak hasil untuk referensi</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (+/- </span><span class="si">{</span><span class="n">std</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">) [</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy: 0.90 (+/- 0.03) [KNN (n_neighbors=3)]
Accuracy: 0.90 (+/- 0.04) [KNN (n_neighbors=5)]
Accuracy: 0.90 (+/- 0.04) [StackingClassifier]
</pre></div>
</div>
</div>
</div>
</section>
<section id="output-base-classifier">
<h3>Output Base Classifier<a class="headerlink" href="#output-base-classifier" title="Link to this heading">#</a></h3>
<p>Output dari sebuah base classifier (klasifikasi dasar) adalah prediksi kelas atau probabilitas untuk setiap kelas yang dihasilkan oleh model machine learning yang sederhana atau mendasar. Base classifier biasanya digunakan sebagai komponen dalam metode ensemble learning, seperti bagging, boosting, atau stacking, di mana mereka digabungkan untuk membentuk model yang lebih kuat dan akurat.</p>
<p>dalam data ini, kami menggunakan ensemble learning berupa bagging dan stacking. dan metode yang kami gunakan menggunakan metode KNN dan Naive Bayes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span> 
<span class="kn">from</span> <span class="nn">mlxtend.classifier</span> <span class="kn">import</span> <span class="n">StackingClassifier</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="c1"># Membaca fitur (X) dari &#39;holesale_customers-Xtrain.csv&#39; &amp; target variable (y) dari &#39;wholesale_customers-ytrain.csv&#39;</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-Xtrain.csv&quot;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-ytrain.csv&quot;</span><span class="p">)[</span><span class="s2">&quot;Channel&quot;</span><span class="p">]</span>

<span class="c1"># Inisialisasi base classifiers and meta-classifier</span>
<span class="n">clf1</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">clf2</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">sclf</span> <span class="o">=</span> <span class="n">StackingClassifier</span><span class="p">(</span><span class="n">classifiers</span><span class="o">=</span><span class="p">[</span><span class="n">clf1</span><span class="p">,</span> <span class="n">clf2</span><span class="p">],</span> <span class="n">meta_classifier</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>

<span class="c1"># Inisialisasi models untuk prediksi</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">clf1</span><span class="p">,</span> <span class="n">clf2</span><span class="p">,</span> <span class="n">sclf</span><span class="p">]</span>
<span class="n">model_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;KNN (n_neighbors=3)&#39;</span><span class="p">,</span> <span class="s1">&#39;KNN (n_neighbors=5)&#39;</span><span class="p">,</span> <span class="s1">&#39;StackingClassifier&#39;</span><span class="p">]</span>

<span class="c1"># Iterasi antar models</span>
<span class="k">for</span> <span class="n">clf</span><span class="p">,</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">model_names</span><span class="p">):</span>
  <span class="c1"># Train model</span>
  <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

  <span class="c1"># Memprediksi variabel target untuk setiap titik data</span>
  <span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

  <span class="c1"># Membuat DataFrame dengan variabel target prediksi</span>
  <span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Data Index&#39;</span><span class="p">:</span> <span class="n">X</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;Predicted Target&#39;</span><span class="p">:</span> <span class="n">y_pred</span><span class="p">})</span>

  <span class="c1"># Menyimpan hasil ke CSV</span>
  <span class="n">results_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s1">_predictions.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Predictions saved for </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">_predictions.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Predictions saved for KNN (n_neighbors=3) to KNN (n_neighbors=3)_predictions.csv
Predictions saved for KNN (n_neighbors=5) to KNN (n_neighbors=5)_predictions.csv
Predictions saved for StackingClassifier to StackingClassifier_predictions.csv
</pre></div>
</div>
</div>
</div>
</section>
<section id="meta-classifier">
<h3>Meta Classifier<a class="headerlink" href="#meta-classifier" title="Link to this heading">#</a></h3>
<p>Meta classifier adalah model pembelajaran mesin yang digunakan untuk menggabungkan atau mengonsolidasi prediksi dari beberapa base classifier dalam metode ensemble learning. Meta classifier bekerja pada tingkat yang lebih tinggi daripada base classifier, mengambil hasil prediksi dari beberapa base classifier dan menggabungkannya untuk menghasilkan prediksi akhir yang lebih akurat.</p>
<p>Meta classifier adalah model penting dalam teknik ensemble yang menggabungkan prediksi dari beberapa base classifier untuk menghasilkan hasil akhir yang lebih akurat dan andal. Dengan belajar dari kekuatan dan kelemahan base classifier, meta classifier membantu meningkatkan kinerja keseluruhan sistem pembelajaran mesin.</p>
<p>Implementasi saat menggunakan perhitungan manual beserta visualisasi confusion matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">model_selection</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">mlxtend.classifier</span> <span class="kn">import</span> <span class="n">StackingClassifier</span>  <span class="c1"># Import from mlxtend</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="c1"># Load training data (X, y)</span>
<span class="k">try</span><span class="p">:</span>
  <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-Xtrain.csv&quot;</span><span class="p">)</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-ytrain.csv&quot;</span><span class="p">)[</span><span class="s2">&quot;Channel&quot;</span><span class="p">]</span>
<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Training data files not found. Please check file paths.&quot;</span><span class="p">)</span>
  <span class="n">exit</span><span class="p">()</span>

<span class="c1"># Mendefinisikan base classifiers</span>
<span class="n">clf1</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">clf2</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Train base classifiers dalam training data (X, y)</span>
<span class="n">clf1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">clf2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Load test data (X_test, y_test)</span>
<span class="k">try</span><span class="p">:</span>
  <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-Xtest.csv&quot;</span><span class="p">)</span>
  <span class="n">y_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-ytest.csv&quot;</span><span class="p">)[</span><span class="s2">&quot;Channel&quot;</span><span class="p">]</span>  <span class="c1"># Assuming target column name</span>
<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Test data files not found. Please check file paths.&quot;</span><span class="p">)</span>
  <span class="n">exit</span><span class="p">()</span>

<span class="c1"># Mempersiapkan fitur untuk StackingClassifier (Skenario 1)</span>
<span class="k">if</span> <span class="s2">&quot;knn_k3&quot;</span> <span class="ow">and</span> <span class="s2">&quot;knn_k5&quot;</span> <span class="ow">in</span> <span class="n">X_test</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
  <span class="n">X_stacking</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">[[</span><span class="s2">&quot;knn_k3&quot;</span><span class="p">,</span> <span class="s2">&quot;knn_k5&quot;</span><span class="p">]]</span>  <span class="c1"># Select columns if they exist</span>
<span class="k">else</span><span class="p">:</span>
  <span class="c1"># Mempersiapkan fitur berdasarkan prediksi dari base classifiers (Skenario 2)</span>
  <span class="n">X_stacking</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;knn_k3&#39;</span><span class="p">:</span> <span class="n">clf1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="s1">&#39;knn_k5&#39;</span><span class="p">:</span> <span class="n">clf2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)})</span>

<span class="c1"># Mendefinisikan meta-classifier</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>

<span class="c1"># Train StackingClassifier pada fitur yang telah disiapkan dan variabel target (y_test)</span>
<span class="n">sclf</span> <span class="o">=</span> <span class="n">StackingClassifier</span><span class="p">(</span><span class="n">classifiers</span><span class="o">=</span><span class="p">[</span><span class="n">clf1</span><span class="p">,</span> <span class="n">clf2</span><span class="p">],</span> <span class="n">meta_classifier</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>  <span class="c1"># Use `classifiers` argument</span>
<span class="n">clf</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_stacking</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="c1"># Mengevaluasi kinerja StackingClassifier pada data test</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">model_selection</span><span class="o">.</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">sclf</span><span class="p">,</span> <span class="n">X_stacking</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;StackingClassifier Accuracy on Test Data: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (+/- </span><span class="si">{</span><span class="n">std</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>StackingClassifier Accuracy on Test Data: 0.89 (+/- 0.03)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># Import seaborn untuk visualisasi data</span>

<span class="c1"># Perhitungan confusion matrix</span>
<span class="n">sclf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_stacking</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">sclf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_stacking</span><span class="p">)</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="c1"># Visualisasi confusion matrix dengan Matplotlib</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>  <span class="c1"># Sesuaikan ukuran gambar jika diperlukan</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>  <span class="c1"># Buatkan heatmap</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>  <span class="c1"># Tambahkan colorbar untuk visualisasi value warna mapping</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Confusion Matrix&#39;</span><span class="p">)</span>  <span class="c1"># Set the title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted Label&#39;</span><span class="p">)</span>  <span class="c1"># Label the x-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True Label&#39;</span><span class="p">)</span>  <span class="c1"># Label the y-axis</span>

<span class="c1"># Menambahkan label untuk setiap sel dalam matriks</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cm</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cm</span><span class="p">)):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">cm</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>  <span class="c1"># Sesuaikan posisi teks jika diperlukan</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">]))],</span> <span class="p">[</span><span class="s1">&#39;Predicted </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">]))])</span>  <span class="c1"># Set x-axis labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cm</span><span class="p">))]</span> <span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Actual </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cm</span><span class="p">))])</span>  <span class="c1"># Set y-axis labels</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># Sesuaikan layout untuk menghindari element yang saling tumpang tindih</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  <span class="c1"># Menampilkan hasil confusion matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/05b0cedc76462c9c0d1a6a95b1f6cf4d7dd1622773fb08ed91a6e489c80c3565.png"><img alt="_images/05b0cedc76462c9c0d1a6a95b1f6cf4d7dd1622773fb08ed91a6e489c80c3565.png" src="_images/05b0cedc76462c9c0d1a6a95b1f6cf4d7dd1622773fb08ed91a6e489c80c3565.png" style="width: 699px; height: 590px;" /></a>
</div>
</div>
<p>Implementasi menggunakan Library Scikit Learn:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">accuracy_score</span>

<span class="c1"># Membaca Dataset</span>
<span class="k">try</span><span class="p">:</span>
    <span class="c1"># Data training</span>
    <span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-Xtrain.csv&quot;</span><span class="p">)</span>
    <span class="n">y_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-ytrain.csv&quot;</span><span class="p">)[</span><span class="s2">&quot;Channel&quot;</span><span class="p">]</span>

    <span class="c1"># Data testing</span>
    <span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-Xtest.csv&quot;</span><span class="p">)</span>
    <span class="n">y_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-ytest.csv&quot;</span><span class="p">)[</span><span class="s2">&quot;Channel&quot;</span><span class="p">]</span>
<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Training or test data files not found. Please check file paths.&quot;</span><span class="p">)</span>
    <span class="n">exit</span><span class="p">()</span>

<span class="c1"># Base Classifiers (K-Nearest Neighbors)</span>
<span class="n">clf1</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">clf2</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Meta-classifier (Gaussian Naive Bayes)</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>

<span class="c1"># StackingClassifier for Ensemble Learning</span>
<span class="n">sclf</span> <span class="o">=</span> <span class="n">StackingClassifier</span><span class="p">(</span><span class="n">classifiers</span><span class="o">=</span><span class="p">[</span><span class="n">clf1</span><span class="p">,</span> <span class="n">clf2</span><span class="p">],</span> <span class="n">meta_classifier</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>

<span class="n">sclf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">sclf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predictions:&quot;</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cm</span><span class="p">)</span>

<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy on Test Set: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Predictions: [2 1 2 1 1 1 1 2 1 1 1 1 2 1 2 1 2 2 1 1 2 1 2 1 1 1 1 1 1 1 2 2 1 1 1 1 1
 2 1 1 1 1 1 1 2 1 1 2 2 1 2 1 1 1 2 2 1 1 2 2 1 1 1 2 1 2 2 2 1 1 2 1 1 1
 1 1 1 1 2 1 1 1 1 2 2 2 1 1]
Confusion Matrix:
 [[56  9]
 [ 3 20]]
Accuracy on Test Set: 0.86
</pre></div>
</div>
</div>
</div>
</section>
<section id="ensemble-learning-bagging">
<h3>Ensemble Learning - Bagging<a class="headerlink" href="#ensemble-learning-bagging" title="Link to this heading">#</a></h3>
<p>Penjelasan konsep bagging adalah metaestimator ansambel yang menyesuaikan pengklasifikasi dasar masing-masing pada subset acak dari kumpulan data asli dan kemusian menggabungkan prediksi individualnya.</p>
<p>Penerapan bagging melibatkan langkah, berikut gambaran umumnya:</p>
<ul class="simple">
<li><p>Persiapan kumpulan data: siapkan kumpulan data anda, pastikan kumpulan data tersebut dibersihkan dan diproses sebelumnya dengan benar, bagi menjadi set pelatihan dan set pengujian</p></li>
</ul>
<ul class="simple">
<li><p>Pengambilan Sampel Bootstrap: Sampel acak dari kumpulan data pelatihan dengan penggantian untuk membuat beberapa sampel bootstrap. Setiap sampel bootstrap biasanya harus memiliki ukuran yang sama dengan kumpulan data asli, namun beberapa titik data mungkin diulang sementara yang lain mungkin dihilangkan.</p></li>
</ul>
<ul class="simple">
<li><p>Pelatihan Model: Melatih model dasar (misalnya, pohon keputusan, jaringan saraf, dll.) pada setiap sampel bootstrap. Setiap model harus dilatih secara independen satu sama lain.</p></li>
</ul>
<ul class="simple">
<li><p>Pembuatan Prediksi: Gunakan setiap model yang dilatih untuk memprediksi kumpulan data pengujian.</p></li>
</ul>
<ul class="simple">
<li><p>Menggabungkan Prediksi: Menggabungkan prediksi dari semua model. Anda dapat menggunakan pemungutan suara mayoritas untuk menentukan prediksi kelas akhir untuk tugas klasifikasi. Untuk tugas regresi , Anda dapat membuat rata-rata prediksi.</p></li>
</ul>
<ul class="simple">
<li><p>Evaluasi: Evaluasi kinerja ansambel bagging pada kumpulan data pengujian menggunakan metrik yang sesuai (misalnya, akurasi, skor F1, kesalahan kuadrat rata-rata, dll.).</p></li>
</ul>
<ul class="simple">
<li><p>Penyetelan Hyperparameter: Jika perlu, sesuaikan hyperparameter model dasar atau ansambel bagging itu sendiri menggunakan teknik seperti validasi silang.</p></li>
</ul>
<ul class="simple">
<li><p>Penerapan: Setelah Anda puas dengan kinerja ansambel bagging, terapkan untuk membuat prediksi pada data baru yang tidak terlihat.</p></li>
</ul>
<p>Berikut contoh penggunaan Bagging Classifier dengan data dummy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># Data Training</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-Xtrain.csv&quot;</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-ytrain.csv&quot;</span><span class="p">)[</span><span class="s2">&quot;Channel&quot;</span><span class="p">]</span>

<span class="c1"># Data Testing</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-Xtest.csv&quot;</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-ytest.csv&quot;</span><span class="p">)[</span><span class="s2">&quot;Channel&quot;</span><span class="p">]</span>

<span class="c1"># Create a Bagging Classifier using an SVC base estimator (corrected)</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="n">SVC</span><span class="p">(),</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Train the Bagging Classifier on the training data</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="c1"># Evaluate the Bagging Classifier&#39;s performance (optional)</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy on Training Set: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy on Training Set: 0.92
</pre></div>
</div>
</div>
</div>
<p>Sedangkan, berikut ini merupakan implementasi Bagging Classifier ini dengan dataset Wholesale Customers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-Xtrain.csv&quot;</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-ytrain.csv&quot;</span><span class="p">)[</span><span class="s2">&quot;Channel&quot;</span><span class="p">]</span>

<span class="c1"># Menentukan Pengklasifikasi Bagging dengan nilai n_estimator yang berbeda</span>
<span class="n">estimators</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5909</span><span class="p">,</span> <span class="mi">23527</span><span class="p">,</span> <span class="mi">13699</span><span class="p">,</span> <span class="mi">10155</span><span class="p">,</span> <span class="mi">830</span><span class="p">,</span> <span class="mi">3636</span><span class="p">]</span>
<span class="n">classifiers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">estimators</span><span class="p">:</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="n">GaussianNB</span><span class="p">(),</span> <span class="n">n_estimators</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">classifiers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span>

<span class="c1"># Mengevaluasi setiap Pengklasifikasi Bagging dengan n_estimator yang berbeda</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">clf</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">classifiers</span><span class="p">):</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy (n_estimators=</span><span class="si">{</span><span class="n">estimators</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy (n_estimators=1): 0.89
Accuracy (n_estimators=5909): 0.90
Accuracy (n_estimators=23527): 0.90
Accuracy (n_estimators=13699): 0.90
Accuracy (n_estimators=10155): 0.90
Accuracy (n_estimators=830): 0.90
Accuracy (n_estimators=3636): 0.90
</pre></div>
</div>
</div>
</div>
<p>Klasifikasi Bagging dengan n_estimator = 3 (accurary terbaik dalam hasil uji sebelumnya) sekaligus menyimpan hasil model ke pickle file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">BaggingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">import</span> <span class="nn">pickle</span>  <span class="c1"># Import pickle for saving models</span>

<span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-Xtrain.csv&quot;</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;wholesale_customers-ytrain.csv&quot;</span><span class="p">)[</span><span class="s2">&quot;Channel&quot;</span><span class="p">]</span>

<span class="c1"># Tentukan Pengklasifikasi Bagging dengan n_estimator = 3 (fokus pada konfigurasi ini)</span>
<span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="n">GaussianNB</span><span class="p">(),</span> <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Train and evaluate the Bagging Classifier</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>  <span class="c1"># Assuming training set for evaluation</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy (n_estimators=</span><span class="si">{</span><span class="n">n_estimators</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Save the model to a pickle file</span>
<span class="n">model_filename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;BaggingClassifier_n_estimators_</span><span class="si">{</span><span class="n">n_estimators</span><span class="si">}</span><span class="s2">.pkl&quot;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">model_filename</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model saved to file: </span><span class="si">{</span><span class="n">model_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Accuracy (n_estimators=3): 0.89
Model saved to file: BaggingClassifier_n_estimators_3.pkl
</pre></div>
</div>
</div>
</div>
<p>Uji coba load model dari hasil pickle: (load berhasil/tanpa error):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;BaggingClassifier_n_estimators_3.pkl&quot;</span>

<span class="c1">#load</span>
<span class="n">loaded_model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="evaluasi-dataset">
<h2>Evaluasi Dataset<a class="headerlink" href="#evaluasi-dataset" title="Link to this heading">#</a></h2>
<p>Dataset Wholesale_customers berisi informasi tentang pengeluaran tahunan pelanggan grosir pada berbagai kategori produk. Tujuannya adalah untuk memprediksi saluran distribusi (antara Horeca atau Retail) berdasarkan pola pengeluaran ini.</p>
<p>Berdasarkan analisis yang telah dilakukan terhadap dataset Wholesale Customers, berikut adalah beberapa poin penting untuk evaluasi dataset:</p>
<ul class="simple">
<li><p>Meningkatkan jumlah estimator dasar umumnya meningkatkan akurasi model, menunjukkan bahwa menggabungkan beberapa model membantu menangkap pola dasar dalam data dengan lebih baik.</p></li>
</ul>
<ul class="simple">
<li><p>peningkatan marginal dalam akurasi cenderung menurun seiring dengan peningkatan jumlah estimator.</p></li>
</ul>
<ul class="simple">
<li><p>Classifier Bagging dengan Gaussian Naive Bayes sebagai estimator dasar menunjukkan performa yang baik dalam memprediksi saluran distribusi pada dataset Wholesale_customers.</p></li>
</ul>
<ul class="simple">
<li><p>pendekatan Bagging membantu meningkatkan stabilitas dan akurasi model dengan mengurangi varians prediksi.</p></li>
</ul>
<p>Menggunakan Bagging dengan estimator dasar Gaussian Naive Bayes pada dataset Wholesale_customers dapat meningkatkan akurasi prediksi saluran distribusi. Menggabungkan beberapa estimator dasar membantu dalam menangkap pola pengeluaran pelanggan dengan lebih baik, yang menghasilkan prediksi yang lebih andal.</p>
</section>
<section id="deploy-dataset">
<h2>Deploy Dataset<a class="headerlink" href="#deploy-dataset" title="Link to this heading">#</a></h2>
<p>Proses deploy dataset ke website melibatkan beberapa langkah utama:</p>
<ul class="simple">
<li><p>Pengembangan Model: Model machine learning (ML) dilatih menggunakan Car Evaluation dataset untuk menghasilkan prediksi atau klasifikasi yang menggunakan metode Bagging dengan akurasi terbaik sebesar 0.89. Model ini disimpan dalam format file pickle.</p></li>
</ul>
<ul class="simple">
<li><p>Pengembangan Aplikasi Web: Aplikasi web Flask diimplementasikan untuk menyediakan antarmuka pengguna (UI) bagi user untuk berinteraksi dengan model yang telah dilatih. Aplikasi ini memuat file pickle yang berisi model dan menggunakannya untuk memproses data input pengguna dan menghasilkan prediksi penilaian keseluruhan mobil berdasarkan fitur-fiturnya. Note: Proses code dalam tahap ini kami tidak tampilkan dengan alasan privacy dan menghindari adanya plagiasi dengan aplikasi serupa.</p></li>
</ul>
<ul class="simple">
<li><p>Deployment ke PythonAnywhere: Aplikasi web Flask di-deploy ke platform hosting web PythonAnywhere. PythonAnywhere menyediakan infrastruktur dan tools untuk menjalankan aplikasi web Python dengan mudah.</p></li>
</ul>
<p>Hasil Website ada Di Link sebagai berikut: <a class="reference external" href="https://zahfi.pythonanywhere.com/">https://zahfi.pythonanywhere.com/</a></p>
<p>Hasil website tersebut merupakan contoh implementasi deploy dataset ke website dengan Flask dan file pickle. Website ini dapat digunakan pengguna untuk memasukkan informasi terkait Customers dan mendapatkan prediksi nilai mobil berdasarkan fitur-fiturnya.</p>
<p>Penjelasan Lebih Detail:</p>
<ul class="simple">
<li><p>Pengembangan Model: Model ML yang digunakan dalam website ini dilatih menggunakan dataset mobil dan nilai jualnya(class/output) dalam data training. Model ini dilatih menggunakan metode Bagging sebagai accuracy terbaik yang telah disinggung pada penjelasan sebelumnya, untuk mempelajari pola hubungan antara fitur mobil dan class/output dari penilaian keseluruhan mobil itu.</p></li>
</ul>
<ul class="simple">
<li><p>Pengembangan Aplikasi Web: Aplikasi web Flask dikembangkan untuk menyediakan antarmuka bagi pengguna untuk memasukkan informasi mobil dan mendapatkan prediksi nilai mobil berdasarkan fiturnya. Aplikasi ini terdiri dari kode Python yang menggunakan framework Flask untuk membangun UI dengan bantuan Boostrap untuk layout dan icon pendukung lainnya serta menghubungkannya dengan model ML yang telah dilatih(pickle file).</p></li>
</ul>
<ul class="simple">
<li><p>Deployment ke PythonAnywhere: Aplikasi web Flask di-deploy ke PythonAnywhere dengan langkah-langkah berikut:</p></li>
</ul>
<blockquote>
<div><p>Membuat akun PythonAnywhere: Pengguna membuat akun di PythonAnywhere dan memilih plan yang sesuai.</p>
</div></blockquote>
<blockquote>
<div><p>Menambahkan aplikasi web: Pengguna menambahkan aplikasi web baru di PythonAnywhere dan menghubungkannya dengan direktori lokal yang berisi kode aplikasi Flask.</p>
</div></blockquote>
<blockquote>
<div><p>Menentukan konfigurasi: Pengguna mengonfigurasi PythonAnywhere untuk menjalankan aplikasi web Flask, termasuk mengatur environment variables dan dependencies yang diperlukan.</p>
</div></blockquote>
<blockquote>
<div><p>Aplikasi web Flask berhasil di deploy: Pengguna telah berhasil deploy website yang telah dibuat ke PythonAnywhere dan sekarang dapat diakses oleh public/seluruh orang yang ingin mengakses website kita.</p>
</div></blockquote>
</section>
<section id="kesimpulan">
<h2>Kesimpulan<a class="headerlink" href="#kesimpulan" title="Link to this heading">#</a></h2>
<p>Perjalanan kita dalam memahami wholesale customers dataset melalui data mining dan website prediktif telah sampai di penghujung. Dari proses awal menggali informasi dari dataset wholesale customers, kita telah menjelajahi berbagai teknik data mining untuk mengolah dan menganalisis data. Kita telah membangun model machine learning yang mampu memprediksi penilaian mobil berdasarkan fiturnya dengan tingkat akurasi yang dihasilkan.</p>
<p>Kini, model tersebut telah terwujud dalam website yang mudah diakses dan digunakan. Manager dari berbagai kalangan dapat dengan mudah memasukkan informasicustomer mereka dan mendapatkan prediksi penilaian customers berdasarkan fiturnya yang terpercaya. Website ini merupakan bukti nyata bagaimana data mining dan machine learning dapat dimanfaatkan untuk memberikan solusi praktis dan bermanfaat dalam kehidupan sehari-hari.</p>
<p>Proses deploy dataset ke website ini membuka peluang baru untuk pengembangan aplikasi prediktif di berbagai bidang. Kita dapat membayangkan website serupa untuk memprediksi harga rumah, nilai saham, atau bahkan risiko kesehatan. Potensi data mining dan machine learning masih luas dan terus berkembang, siap untuk dijelajahi dan dimanfaatkan untuk kebaikan.</p>
<p>Semoga penjelasan ini dapat membantu Anda memahami proses data mining dan website prediktif dengan lebih mudah. Ingatlah bahwa data adalah harta karun yang terpendam, dan data mining adalah kunci untuk membuka potensinya. Gunakan data mining dengan bijak dan ciptakan solusi inovatif yang bermanfaat bagi banyak orang!</p>
<a style='text-decoration:none;line-height:16px;display:flex;color:#5B5B62;padding:10px;justify-content:end;' href='https://deepnote.com?utm_source=created-in-deepnote-cell&projectId=5cb475b4-12a1-4c94-971c-6f8ce4c076a2' target="_blank">
<img alt='Created in deepnote.com' style='display:inline;max-height:16px;margin:0px;margin-right:7.5px;' src='data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iODBweCIgaGVpZ2h0PSI4MHB4IiB2aWV3Qm94PSIwIDAgODAgODAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU0LjEgKDc2NDkwKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5Hcm91cCAzPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkxhbmRpbmciIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJBcnRib2FyZCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEyMzUuMDAwMDAwLCAtNzkuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJHcm91cC0zIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjM1LjAwMDAwMCwgNzkuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aC0yMCIgZmlsbD0iIzAyNjVCNCIgcG9pbnRzPSIyLjM3NjIzNzYyIDgwIDM4LjA0NzY2NjcgODAgNTcuODIxNzgyMiA3My44MDU3NTkyIDU3LjgyMTc4MjIgMzIuNzU5MjczOSAzOS4xNDAyMjc4IDMxLjY4MzE2ODMiPjwvcG9seWdvbj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zNS4wMDc3MTgsODAgQzQyLjkwNjIwMDcsNzYuNDU0OTM1OCA0Ny41NjQ5MTY3LDcxLjU0MjI2NzEgNDguOTgzODY2LDY1LjI2MTk5MzkgQzUxLjExMjI4OTksNTUuODQxNTg0MiA0MS42NzcxNzk1LDQ5LjIxMjIyODQgMjUuNjIzOTg0Niw0OS4yMTIyMjg0IEMyNS40ODQ5Mjg5LDQ5LjEyNjg0NDggMjkuODI2MTI5Niw0My4yODM4MjQ4IDM4LjY0NzU4NjksMzEuNjgzMTY4MyBMNzIuODcxMjg3MSwzMi41NTQ0MjUgTDY1LjI4MDk3Myw2Ny42NzYzNDIxIEw1MS4xMTIyODk5LDc3LjM3NjE0NCBMMzUuMDA3NzE4LDgwIFoiIGlkPSJQYXRoLTIyIiBmaWxsPSIjMDAyODY4Ij48L3BhdGg+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMCwzNy43MzA0NDA1IEwyNy4xMTQ1MzcsMC4yNTcxMTE0MzYgQzYyLjM3MTUxMjMsLTEuOTkwNzE3MDEgODAsMTAuNTAwMzkyNyA4MCwzNy43MzA0NDA1IEM4MCw2NC45NjA0ODgyIDY0Ljc3NjUwMzgsNzkuMDUwMzQxNCAzNC4zMjk1MTEzLDgwIEM0Ny4wNTUzNDg5LDc3LjU2NzA4MDggNTMuNDE4MjY3Nyw3MC4zMTM2MTAzIDUzLjQxODI2NzcsNTguMjM5NTg4NSBDNTMuNDE4MjY3Nyw0MC4xMjg1NTU3IDM2LjMwMzk1NDQsMzcuNzMwNDQwNSAyNS4yMjc0MTcsMzcuNzMwNDQwNSBDMTcuODQzMDU4NiwzNy43MzA0NDA1IDkuNDMzOTE5NjYsMzcuNzMwNDQwNSAwLDM3LjczMDQ0MDUgWiIgaWQ9IlBhdGgtMTkiIGZpbGw9IiMzNzkzRUYiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+' > </img>
Created in <span style='font-weight:600;margin-left:4px;'>Deepnote</span></a></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wholesale-customers-dataset">wholesale customers Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#memahami-dataset">Memahami Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-dataset-from-python">Import Dataset From Python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-dataset-ke-csv">Convert Dataset Ke CSV</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menarik-data-dari-mysql">Menarik Data dari Mysql</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visual-tiap-fitur-dataset-wholesale-customers">Visual Tiap Fitur Dataset Wholesale Customers</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepocessing-data">Prepocessing Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mengidentifikasi-missing-values">Mengidentifikasi Missing Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mengidentifikasi-outlier">Mengidentifikasi Outlier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#encoding-data">Encoding Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mengidentifikasi-algoritma-knn">Mengidentifikasi Algoritma KNN</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mengidentifikasi-lof">Mengidentifikasi LOF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#klasifikasi-naive-bayes">Klasifikasi Naive Bayes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-dataset">Modeling Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ensemble-learning-stacking">Ensemble Learning - Stacking</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#base-classifier">Base Classifier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#output-base-classifier">Output Base Classifier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meta-classifier">Meta Classifier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ensemble-learning-bagging">Ensemble Learning - Bagging</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluasi-dataset">Evaluasi Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deploy-dataset">Deploy Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kesimpulan">Kesimpulan</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>